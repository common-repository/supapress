{"version":3,"sources":["scripts.min.js"],"names":["$","$supapressJQuery","jQuery","noConflict","$wrap","$form","find","$step1","$step2","$message","$element","$selector","$step1NextButton","$widgetTitleWrapper","$widgetTypeWrapper","$widgetTitle","$widgetLayout","$subContentSwitch","$navTab","$navTabContent","$layoutContent","$isbnLookupSource","$isbnLookupBulk","$isbnLookupSourceInputs","$saveButtonWrapper","fadeIn","fadeOut","typeParameter","step2positioning","prependTo","hide","on","$this","this","$label","attr","parent","setTabs","val","setNavContent","hasClass","removeClass","addClass","trigger","$container","selector","each","$elem","show","removeAttr","type","length","filter","prop","getUrlParameter","sParam","sParameterName","i","sPageURL","decodeURIComponent","window","location","search","substring","sURLVariables","split","undefined","$navTabClicked","trim","text","$content","css","$elementParent","parents","$elementArrow","$elementConfig","slideDown","slideUp","scrollTo","click","$isbnList","$price","$retailerLinks","$filters","$sortBy","$perPage","$showPerPage","$perPageInput","$perPageInputButton","$perPageDefault","$asmIsbnLookup","$isbnLookup","$isbnLookupLabel","$lookupCollection","$editCollectionButton","$arrowUpload","$arrowPreview","$clearCacheButton","$addBulkISBNsButton","$addBulkISBNs","isbnLookupAjaxUrl","$supapressAddEditForm","$searchFilterLists","$isbnContainer","asmSelect","addItemTarget","animate","hideWhenAdded","highlight","listType","selectClass","sortable","highlightOutsideContainer","removeLabel","svgUrl","insertBefore","html","sort","a","b","arel","brel","ajax","url","data","ISBNs","replace","dataType","success","isbn13","book","label","title","key","$existingOption","$option","selected","data-isbn","found","remove","append","change","number","alert","keypress","e","which","$perPageSelectedOptions","children","$perPageDefaultSelectedOptions","currentPerPageDefaultValue","select2","value","empty","newOption","$priceLocale","siblings","$retailerLink","$filtersAsm","$sortByAsm","resetButton","filesRemoved","updateMessage","tense","error","console","autocomplete","source","request","response","term","predictive","Array","map","item","id","name","minLength","open","menu","element","autoFocus","focus","event","preventDefault","select","ui","keyCode","Event","details","isbn","test","index","$newOption","filters","collection","values","seo_name","data-seo","catalogId","formfieldId","originalFunction","send_to_editor","tb_show","imgurl","tb_remove","$preview","src","placeholder","parseInt","isNaN","$parents","$slug","$urlPattern","tooltip","tooltipClass","content","callback","position","my","at","collision","using","feedback","vertical","horizontal","appendTo","fn","reorderSelect2Dropdown","is","bt","minimumResultsForSearch","dropdownCssClass","message","level","scrollTop","svg4everybody","supapress","bookUrlOptions","example","trackingPatternOptions","resultCountTextOptions","searchTermTextOptions","insertAtCaret","newText","start","end","before","after","selectionStart","selectionEnd","addAutoComplete","options","_renderItem","ul","shiftKey","relativeLink","regex","$bookUrl","obj","RegExp","supapressAdminInit","$resultCountText","$searchTermText","$seoCanonical","$retailerUpload","$retailers","$retailerLinkFormats","$addNewRetailer","$addNewRetailerLoader","supapressAddAutoComplete","count","$dropdowns","$select2","width","$dropdown","dropdown","$formfield","pattern","page","domainProtocolRegExp","errorMessage","pageVal","$retailerName"],"mappings":"CAAA,SAAUA,GACN,GAAIC,GAAmBC,OAAOC,aAC1BC,EAAQH,EAAiB,mBACzBI,EAAQD,EAAME,KAAK,4BACnBC,EAASH,EAAME,KAAK,UACpBE,EAASJ,EAAME,KAAK,UACpBG,EAAWL,EAAME,KAAK,YACtBI,EAAWN,EAAME,KAAK,+BACtBK,EAAYP,EAAME,KAAK,uCACvBM,EAAmBR,EAAME,KAAK,mBAC9BO,EAAsBT,EAAME,KAAK,yBACjCQ,EAAqBV,EAAME,KAAK,wBAChCS,EAAeF,EAAoBP,KAAK,iBACxCU,EAAgBZ,EAAME,KAAK,+BAC3BW,EAAoBb,EAAME,KAAK,uBAC/BY,EAAUd,EAAME,KAAK,YACrBa,EAAiBf,EAAME,KAAK,oBAC5Bc,EAAiBhB,EAAME,KAAK,mBAC5Be,EAAoBjB,EAAME,KAAK,kBAC/BgB,EAAkBlB,EAAME,KAAK,qBAC7BiB,EAA0BnB,EAAME,KAAK,wBACrCkB,EAAqBpB,EAAME,KAAK,wBAChCmB,GAAS,EACTC,GAAU,EACVC,EAAgB,GAChBC,EAAmB,WACfd,EAAmBe,UAAUrB,GAC7BK,EAAoBgB,UAAUrB,GAAQF,KAAK,KAAKwB,OAEhDhB,EAAmBR,KAAK,SAASyB,GAAG,SAAU,WAC1C,GAAIC,GAAQhC,EAAEiC,MACVC,EAASpB,EAAmBR,KAAK,cAAgB0B,EAAMG,KAAK,MAAQ,KAExED,GAAOL,UAAUK,EAAOE,UACxBJ,EAAMH,UAAUG,EAAMI,UAGtBC,EAAQvB,EAAmBR,KAAK,iBAAiBgC,OAGjDC,EAAcpB,EAAgBlB,EAAiB,mBAAmBkC,KAAK,aAGvEI,EAAcnB,EAAgBnB,EAAiB,0BAA0BK,KAAK,iBAAiB6B,KAAK,mBAGxGrB,EAAmBR,KAAK,SAASyB,GAAG,QAAS,WACtCjB,EAAmB0B,SAAS,QAC3B1B,EAAmB2B,YAAY,QAE/B3B,EAAmB4B,SAAS,UAIpC5B,EAAmBR,KAAK,iBAAiBqC,QAAQ,UAGjDN,EAAQvB,EAAmBR,KAAK,iBAAiBgC,OAGjDC,EAAcpB,EAAgBlB,EAAiB,mBAAmBkC,KAAK,aAGvEI,EAAcnB,EAAgBnB,EAAiB,0BAA0BK,KAAK,iBAAiB6B,KAAK,kBAExGI,EAAgB,SAASK,EAAYC,GAEjCD,EAAWE,KAAK,WACZ,GAAId,GAAQhC,EAAEiC,KAGXD,GAAMQ,SAASK,KAAcb,EAAMQ,SAAS,wBAC3B,aAAbK,EACClC,EAAUL,KAAK,4BAA4BwC,KAAK,WAC5C,GAAIC,GAAQ/C,EAAEiC,KAEVc,GAAMP,SAAS,aAAgBO,EAAMP,SAAS1B,EAAmBR,KAAK,iBAAiBgC,OAGvFS,EAAMC,OAFND,EAAMjB,OAAOxB,KAAK,iBAAiB6B,KAAK,WAAW,KAKxC,gBAAbU,GACNb,EAAM1B,KAAK,gCAAgCwC,KAAK,WAC5C,GAAIC,GAAQ/C,EAAEiC,KAEXc,GAAMP,SAAS1B,EAAmBR,KAAK,iBAAiBgC,OACvDS,EAAMC,OAEND,EAAMjB,SAKlBE,EAAMgB,QAENhB,EAAMF,SAKd9B,EAAE,yBAAyB8C,KAAK,WAC5B,GAAIC,GAAQ/C,EAAEiC,KAEXc,GAAMP,SAAS1B,EAAmBR,KAAK,iBAAiBgC,QACvDS,EAAMC,OAEHD,EAAMP,SAAS,uBACdO,EAAMzC,KAAK,UAAU2C,WAAW,cAGpCF,EAAMjB,OAEHiB,EAAMP,SAAS,uBACdO,EAAMzC,KAAK,UAAU6B,KAAK,WAAY,eAMI,gBAAnDrB,EAAmBR,KAAK,iBAAiBgC,QACxClC,EAAME,KAAK,4BAA4BwB,OAEuC,aAA3E7B,EAAiB,0BAA0BK,KAAK,iBAAiBgC,OAChElC,EAAME,KAAK,mBAAmBqC,QAAQ,UAK9ClB,GAAS,EAETC,GAAU,EAGVT,EAAkB0B,QAAQ,UAG1BjB,GAAU,GAEdW,EAAU,SAASa,GACH,oBAATA,GAEK9C,EAAME,KAAK,uCAAuC6C,QAIlD/C,EAAME,KAAK,gCAAgCmC,YAAY,kBAAkBX,OACzE1B,EAAME,KAAK,oCAAoCmC,YAAY,kBAAkBO,OAC7EhC,EAAcoC,OAAO,oBAAoBC,KAAK,WAAW,KALzDjD,EAAME,KAAK,kEAAkEmC,YAAY,kBAAkBX,OAC3Gd,EAAcoC,OAAO,kBAAkBC,KAAK,WAAW,IAM3DjD,EAAME,KAAK,iCAAiCoC,SAAS,kBAAkBM,OACvE5C,EAAME,KAAK,qCAAqCwB,QACjC,mBAAToB,GACN9C,EAAME,KAAK,YAAYmC,YAAY,kBAAkBO,OACrD5C,EAAME,KAAK,0DAA0DwB,OACrE1B,EAAME,KAAK,qCAAqC0C,OAChD5C,EAAME,KAAK,iCAAiCoC,SAAS,oBAErDtC,EAAME,KAAK,YAAYmC,YAAY,kBAAkBO,OACrD5C,EAAME,KAAK,+DAA+DwB,OAC1E1B,EAAME,KAAK,gCAAgCoC,SAAS,oBAG5DY,EAAkB,SAAyBC,GACvC,GAEIC,GACAC,EAHAC,EAAWC,mBAAmBC,OAAOC,SAASC,OAAOC,UAAU,IAC/DC,EAAgBN,EAASO,MAAM,IAInC,KAAKR,EAAI,EAAGA,EAAIO,EAAcb,OAAQM,IAGlC,GAFAD,EAAiBQ,EAAcP,GAAGQ,MAAM,KAEpCT,EAAe,KAAOD,EACtB,MAA6BW,UAAtBV,EAAe,GAAmB,GAAKA,EAAe,GAM7EtC,GAAQa,GAAG,QAAS,WAChB,GAAIoC,GAAiBnE,EAAEiC,KACOT,GAAmBgB,SAAS,OAG1DtB,GAAQuB,YAAY,kBACpB0B,EAAezB,SAAS,kBAGxBH,EAAcpB,EAAgBgD,EAAehC,KAAK,eAItDnB,EAAce,GAAG,SAAU,WAEvBQ,EAAcnB,EAAgBpB,EAAEiC,MAAME,KAAK,mBAI/CI,EAAcnB,EAAgBpB,EAAE,uCAAuCmC,KAAK,iBAG5Ed,EAAkBU,GAAG,SAAU,WAC3BR,EAAwBuB,KAAK,WACzB,GAAId,GAAQhC,EAAEiC,KAGXD,GAAMQ,SAASnB,EAAkBiB,OAChCN,EAAMgB,OAENhB,EAAMF,WAMlBT,EAAkBsB,QAAQ,UAG1B/B,EAAiBmB,GAAG,QAAS,WACS,KAA/B/B,EAAEoE,KAAKrD,EAAauB,QACnB7B,EAASiC,SAAS,WAAWD,YAAY,QACzChC,EAASH,KAAK,KAAK+D,KAAK,yCAExB9D,EAAOuB,OACPtB,EAAOwC,OACPvC,EAASiC,SAAS,QAElBd,OAKRX,EAAkBc,GAAG,SAAU,WAC3B,GAAIC,GAAQhC,EAAEiC,MACVqC,EAAWtE,EAAE,OAASgC,EAAMG,KAAK,oBAElCH,GAAMqB,KAAK,aAAeiB,EAAS9B,SAASxC,EAAE,uCAAuCmC,KAAK,kBAAoBmC,EAAS9B,SAAS,cAChG,SAA5B8B,EAASC,IAAI,YAAyB9C,EACrC6C,EAAS7C,SAET6C,EAAStB,OAGkB,SAA5BsB,EAASC,IAAI,YAAyB7C,EACrC4C,EAAS5C,UAET4C,EAASxC,OAKjBL,GAAS,IAIbf,EAASqB,GAAG,QAAS,WACjB,GAAIC,GAAQhC,EAAEiC,MACVuC,EAAiBxC,EAAMyC,QAAQ,gCAC/BC,EAAgBF,EAAelE,KAAK,oBACpCqE,EAAiBH,EAAelE,KAAK,+BAEJ,UAAlCqE,EAAeJ,IAAI,YAClBI,EAAeC,YACfF,EAAchC,SAAS,QACvBV,EAAMU,SAAS,UAEfiC,EAAeE,UACfH,EAAcjC,YAAY,QAC1BT,EAAMS,YAAY,WAK1BpC,EAAM0B,GAAG,SAAU,WACf,MAAkC,KAA/B/B,EAAEoE,KAAKrD,EAAauB,QACnB7B,EAASiC,SAAS,WAAWD,YAAY,QACzChC,EAASH,KAAK,KAAK+D,KAAK,wCACjB,GAC0E,IAA3EjE,EAAME,KAAK,qDAAqD6C,QAEtE1C,EAASiC,SAAS,WAAWD,YAAY,QACzChC,EAASH,KAAK,KAAK+D,KAAK,iEACxBjE,EAAME,KAAK,iCAAiCqC,QAAQ,SAEpDiB,OAAOkB,SAAS,EAAG,IACZ,GACkD,oBAAnDhE,EAAmBR,KAAK,iBAAiBgC,OAAgCtC,EAAE,uCAAuCyE,QAAQ,gCAAgCjC,SAAS1B,EAAmBR,KAAK,iBAAiBgC,OASxJ,gBAAnDxB,EAAmBR,KAAK,iBAAiBgC,OAAuD,SAA5BjB,EAAkBiB,OAA+C,KAA1BhB,EAAgBgB,OAClI7B,EAASiC,SAAS,WAAWD,YAAY,QACzChC,EAASH,KAAK,KAAK+D,KAAK,gFACxBjE,EAAME,KAAK,gCAAgCqC,QAAQ,SAEnDiB,OAAOkB,SAAS,EAAG,IACZ,GACkD,WAAnD9E,EAAE,uCAAuCsC,OAAuBtC,EAAE,uBAAyBA,EAAE,qCAAqCsC,OAAOA,MAA5I,QAGH7B,EAASiC,SAAS,WAAWD,YAAY,QACzChC,EAASH,KAAK,KAAK+D,KAAK,mDACxBjE,EAAME,KAAK,oCAAoCqC,QAAQ,SAEvDiB,OAAOkB,SAAS,EAAG,IACZ,IArBPrE,EAASiC,SAAS,WAAWD,YAAY,QACzChC,EAASH,KAAK,KAAK+D,KAAK,gEACxBjE,EAAME,KAAK,oCAAoCqC,QAAQ,SAEvDiB,OAAOkB,SAAS,EAAG,IACZ,KAqBZ1E,EAAMoC,SAAS,SAEdZ,IAIJD,EAAgB2B,EAAgB,QAC7B3B,IACCb,EAAmBR,KAAK,gBAAkBqB,EAAgB,MAAMoD,QAChExE,EAAOuB,OACPtB,EAAOwC,OACPvC,EAASiC,SAAS,QAElBd,MAEL1B,QAEH,SAAWF,GACP,GAAIC,GAAmBC,OAAOC,aAC1B6E,EAAY/E,EAAiB,cAC7BgF,EAAShF,EAAiB,UAC1BiF,EAAiBjF,EAAiB,mBAClCQ,EAAWR,EAAiB,YAC5BkF,EAAWlF,EAAiB,YAC5BmF,EAAUnF,EAAiB,YAC3BoF,EAAWpF,EAAiB,aAC5BqF,EAAerF,EAAiB,kBAChCsF,EAAgBtF,EAAiB,mBACjCuF,EAAsBvF,EAAiB,uBACvCwF,EAAkBxF,EAAiB,qBACnCyF,EAAiB1F,EAAE,8BACnB2F,EAAc1F,EAAiB,gBAC/B2F,EAAmB3F,EAAiB,sBACpC4F,EAAoB5F,EAAiB,sBACrC6F,EAAwB7F,EAAiB,2BACzC8F,EAAe9F,EAAiB,sCAChC+F,EAAgB/F,EAAiB,0DACjCgG,EAAoBhG,EAAiB,iCACrCiG,EAAsBjG,EAAiB,oCACvCkG,EAAgBlG,EAAiB,qBACjCmG,EAAoBT,EAAYxD,KAAK,iBACrCkE,EAAwBpG,EAAiB,4BACzCqG,EAAqBrG,EAAiB,sCAEtCsG,EAAiBvB,EAAUwB,WAC3BC,cAAe,SACfC,SAAS,EACTC,eAAe,EACfC,WAAW,EACXC,SAAU,KACVC,YAAa,4BACbC,UAAU,EACVC,2BAA2B,EAC3BC,YAAa,IACbC,OAAQlC,EAAU7C,KAAK,iBAG3ByD,GAAiBuB,aAAazB,GAC9BC,EAAYwB,aAAazB,GAGzBT,EAAOmC,KAAKpH,EAAE,SAAUiF,GAAQoC,KAAK,SAAUC,EAAGC,GAC9C,GAAIC,GAAOxH,EAAEsH,GAAGnF,KAAK,OACjBsF,EAAOzH,EAAEuH,GAAGpF,KAAK,MACrB,OAAOqF,IAAQC,EAAO,EAAID,EAAOC,KAAY,KAGjDxC,EAAOuB,WACHC,cAAe,SACfC,SAAS,EACTC,eAAe,EACfC,WAAW,EACXC,SAAU,KACVC,YAAa,2EACbC,UAAU,EACVC,2BAA2B,EAC3BC,YAAa,IACbC,OAAQlC,EAAU7C,KAAK,kBAI3B+C,EAAekC,KAAKpH,EAAE,SAAUkF,GAAgBmC,KAAK,SAAUC,EAAGC,GAC9D,GAAIC,GAAOxH,EAAEsH,GAAGnF,KAAK,OACjBsF,EAAOzH,EAAEuH,GAAGpF,KAAK,MACrB,OAAOqF,IAAQC,EAAO,EAAID,EAAOC,KAAY,KAGjDvC,EAAesB,WACXC,cAAe,SACfC,SAAS,EACTC,eAAe,EACfC,WAAW,EACXC,SAAU,KACVC,YAAa,4EACbC,UAAU,EACVC,2BAA2B,EAC3BC,YAAa,IACbC,OAAQlC,EAAU7C,KAAK,kBAI3B+D,EAAoBnE,GAAG,QAAS,WAC5B/B,EAAE0H,MACEC,IAAK,mDACLzE,KAAM,OACN0E,MACIC,MAAO1B,EAAc7D,MAAMwF,QAAQ,MAAO,KAAKA,QAAQ,KAAM,IAAIA,QAAQ,MAAO,MAEpFC,SAAU,OACVC,QAAS,SAAUJ,GACf,IAAK,GAAIK,KAAUL,GAAKC,MAAO,CAC3B,GAAIK,GAAON,EAAKC,MAAMI,GAClBE,EAAQD,EAAKE,MAAQ,KAAOH,EAAS,IACrCI,EAAMJ,EAAS,MAAQC,EAAKE,MAC5BE,EAAkBtD,EAAU1E,KAAK,qBAAuB2H,EAAS,eACjEM,EAAUvI,EAAE,YAAYqE,KAAK8D,GAAO7F,IAAI+F,GAAKlG,MACzCqG,UAAY,EACZC,YAAaR,GAGjBC,GAAKQ,YACLH,EAAQ7F,SAAS,kBAGU,IAA3B4F,EAAgBnF,QAChBmF,EAAgBK,SAGpB3D,EAAU4D,OAAOL,GAGrBvD,EAAU6D,SACV1C,EAAc7D,IAAI,SAM9BkD,EAAoBzD,GAAG,QAAS,WAC5B,GAAI+G,GAAS9I,EAAE,mBAAmBsC,KAalC,OAXIwG,GAAS,KAAOA,EAAS,EACzBC,MAAM,sCACC/I,EAAE,oCAAsC8I,EAAS,MAAM3F,OAC9D4F,MAAMD,EAAS,yBACRA,IACPrD,EAAgBmD,OAAO5I,EAAE,qBAAqBqE,KAAKyE,GAAQ3G,KAAK,QAAS2G,IACzEzD,EAASuD,OAAO5I,EAAE,qBAAqBqE,KAAKyE,GAAQ3G,KAAK,YAAY,GAAMA,KAAK,QAAS2G,IAASD,UAGtGtD,EAAcjD,IAAI,KAEX,IAIXiD,EAAcyD,SAAS,SAAUC,GAC7B,GAAe,IAAXA,EAAEC,MAEF,MADA1D,GAAoBT,SACb,IAIfM,EAASmB,WACLC,cAAe,SACfC,SAAS,EACTC,eAAe,EACfC,WAAW,EACXC,SAAU,KACVC,YAAa,OACbC,UAAU,EACVC,2BAA2B,EAC3BC,YAAa,IACbC,OAAQlC,EAAU7C,KAAK,kBAI3BnC,EAAE,QAAQ+B,GAAG,SAAU,YAAa,WAChC,GAAIoH,GAA0B9D,EAAS+D,SAAS,mBAC5CC,EAAiC5D,EAAgB2D,SAAS,SAG9D,IAAID,EAAwBhG,SAAWkG,EAA+BlG,OAClE,OAAO,CAIX,IAAImG,GAA6B7D,EAAgB8D,QAAQ,MAGzDJ,GAAwB9B,KAAK,SAAUC,EAAGC,GAGtC,MAFAD,GAAIA,EAAEkC,MACNjC,EAAIA,EAAEiC,MACClC,EAAIC,IAIf9B,EAAgBgE,QAAQb,OAAO5I,EAAE,YAAYqE,KAAK,kBAAkB/B,IAAI,KAGxE6G,EAAwBrG,KAAK,WACzB,GAAI4G,GAAY1J,EAAE,YAAYqE,KAAKrE,EAAEiC,MAAMK,OAAOA,IAAItC,EAAEiC,MAAMK,MAC1DgH,KAA+BtJ,EAAEiC,MAAMK,OACvCoH,EAAUvH,KAAK,YAAY,GAE/BsD,EAAgBmD,OAAOc,KAItBjE,EAAgB8D,QAAQ,SAEzB9D,EAAgB8D,QAAQ,MAAO,IAC3BD,GACAP,MAAM,6CAMlB1D,EAAS+B,KAAKpH,EAAE,SAAUqF,GAAUgC,KAAK,SAAUC,EAAGC,GAClD,GAAIC,GAAOxH,EAAEsH,GAAGnF,KAAK,OACjBsF,EAAOzH,EAAEuH,GAAGpF,KAAK,MACrB,OAAOqF,IAAQC,EAAO,EAAID,EAAOC,KAAY,IAIjD,IAAIkC,GAAe3J,EAAE,8BACrB2J,GAAa9H,UAAU8H,EAAalF,QAAQ,6BAC5CkF,EAAaC,SAAS,SAAS/H,UAAU8H,EAAalF,QAAQ,4BAE9D,IAAIoF,GAAgB7J,EAAE,+BACtB6J,GAAchI,UAAUgI,EAAcpF,QAAQ,6BAC9CoF,EAAcD,SAAS,SAAS/H,UAAUgI,EAAcpF,QAAQ,6BAGhEU,EAASiC,KAAKpH,EAAE,SAAUmF,GAAUkC,KAAK,SAAUC,EAAGC,GAClD,GAAIC,GAAOxH,EAAEsH,GAAGnF,KAAK,OACjBsF,EAAOzH,EAAEuH,GAAGpF,KAAK,MACrB,OAAOqF,IAAQC,EAAO,EAAID,EAAOC,KAAY,KAGjDtC,EAASqB,WACLC,cAAe,SACfC,SAAS,EACTC,eAAe,EACfC,WAAW,EACXC,SAAU,KACVC,YAAa,sEACbC,UAAU,EACVC,2BAA2B,EAC3BC,YAAa,IACbC,OAAQlC,EAAU7C,KAAK,iBAI3B,IAAI2H,GAAc9J,EAAE,yBACpB8J,GAAYjI,UAAUiI,EAAYrF,QAAQ,6BAC1CqF,EAAYF,SAAS,SAAS/H,UAAUiI,EAAYrF,QAAQ,6BAG5DW,EAAQgC,KAAKpH,EAAE,SAAUoF,GAASiC,KAAK,SAAUC,EAAGC,GAChD,GAAIC,GAAOxH,EAAEsH,GAAGnF,KAAK,OACjBsF,EAAOzH,EAAEuH,GAAGpF,KAAK,MACrB,OAAOqF,IAAQC,EAAO,EAAID,EAAOC,KAAY,KAGjDrC,EAAQoB,WACJC,cAAe,SACfC,SAAS,EACTC,eAAe,EACfC,WAAW,EACXC,SAAU,KACVC,YAAa,sEACbC,UAAU,EACVC,2BAA2B,EAC3BC,YAAa,IACbC,OAAQlC,EAAU7C,KAAK,iBAI3B,IAAI4H,GAAa/J,EAAE,yBACnB+J,GAAWlI,UAAUkI,EAAWtF,QAAQ,6BACxCsF,EAAWH,SAAS,SAAS/H,UAAUkI,EAAWtF,QAAQ,6BAE1DwB,EAAkBlE,GAAG,QAAS,WAC1B,IAAGkE,EAAkBzD,SAAS,YAA9B,CAGA,GAAIwH,GAAc,WACd/D,EAAkBxD,YAAY,YAC9BwD,EAAkB1B,IAAI,UAAW,GAAGF,KAAK,eAE7C4B,GAAkBvD,SAAS,YAAY6B,IAAI,UAAW,IAAKF,KAAK,eAEhErE,EAAE0H,MACEC,IAAK,8CACLzE,KAAM,MACN6E,SAAU,OACVC,QAAS,SAAUJ,GACf,GAA0B,IAAtBA,EAAKqC,aACLjK,EAAEiC,MAAMiI,cAAc,wCAAyC,eAC5D,CACH,GAAIC,GAA8B,IAAtBvC,EAAKqC,aAAqB,OAAS,QAC/CjK,GAAEiC,MAAMiI,cAActC,EAAKqC,aAAe,eAAiBE,EAAQ,iBAAkB,WAEzFH,KAEJI,MAAO,SAASxC,GACTyC,SAAW,SAAWA,UACrBA,QAAQD,MAAMxC,GAElBoC,UAOZrE,EAAY2E,cACRC,OAAQ,SAAUC,EAASC,GACvBzK,EAAE0H,MACEC,IAAKvB,EAAoB,+BACzBlD,KAAM,OACN0E,MACI8C,KAAM/E,EAAYrD,OAEtB0F,QAAS,SAAUJ,GACS,OAApBA,EAAK+C,YAAuB/C,EAAK+C,qBAAsBC,QACvDH,EAASzK,EAAE6K,IAAIjD,EAAK+C,WAAY,SAAUG,GACtC,GAAuB,mBAAZA,GAAKC,GACZ,OACI5C,MAAO2C,EAAKE,KAAO,KAAOF,EAAKC,GAAK,IACpCvB,MAAOsB,EAAKC,GAAK,MAAQD,EAAKE,SAM9CrF,EAAYlD,YAAY,+BAIpCwI,UAAW,EACXC,KAAM,WACFlL,EAAEiC,MAAM2F,KAAK,kBAAkBuD,KAAKC,QAAQ1I,SAAS,2BAEzD2I,WAAW,EACXC,MAAO,SAAUC,GACbA,EAAMC,kBAEVC,OAAQ,SAAUF,EAAOG,GAGrB,GAFA/F,EAAYrD,IAAIoJ,EAAGZ,KAAKtB,OAEK,mBAAlB+B,GAAMI,SAA6C,KAAlBJ,EAAMI,QAAgB,CAC9D,GAAI1C,GAAI/I,OAAO0L,MAAM,UACrB3C,GAAEC,MAAQD,EAAE0C,QAAU,GACtBhG,EAAYhD,QAAQsG,GAGxBsC,EAAMC,oBAId7F,EAAY5D,GAAG,UAAW,SAAUkH,GAChC,GAAkB,KAAdA,EAAE0C,QAAgB,CAClB,GACIpD,GADAsD,EAAUlG,EAAYrD,MAAM2B,MAAM,MAGtC,IAAI4H,EAAQ1I,OAAS,EAAG,CACpB,GAAI2I,GAAOD,EAAQ,GACfzD,EAAQyD,EAAQ,EAEhB,aAAYE,KAAKD,IAAgF,IAAvE9G,EAAU1E,KAAK,qBAAuBwL,EAAO,eAAe3I,SACtFoF,EAAUvI,EAAE,YAAYqE,KAAK+D,EAAQ,KAAO0D,EAAO,KAAKxJ,IAAIqD,EAAYrD,OAAOH,MAC3EqG,UAAY,EACZC,YAAaqD,IAEjB9G,EAAU4D,OAAOL,GAASM,UAG9BlD,EAAYrD,IAAI,IAAIG,YAAY,+BACzB,YAAYsJ,KAAKpG,EAAYrD,QAA8F,IAApF0C,EAAU1E,KAAK,qBAAuBqF,EAAYrD,MAAQ,eAAea,OACvHnD,EAAE0H,MACEC,IAAKvB,EAAoB,gCACzBlD,KAAM,OACN0E,MACIkE,KAAMnG,EAAYrD,OAEtB0F,QAAS,SAAUJ,GACf,GAAIQ,GACAG,EAAUvI,EAAE,WAEI,iBAAT4H,IACPQ,EAAQ,iBACRG,EAAQ7F,SAAS,mBAEjB0F,EAAQR,EAAK9D,OAAO,GAAGsE,MAG3BG,EAAQlE,KAAK+D,EAAQ,KAAOzC,EAAYrD,MAAQ,KAAKA,IAAIqD,EAAYrD,MAAQ,MAAQ8F,GAAOjG,MACxFqG,UAAY,EACZC,YAAa9C,EAAYrD,QAG7B0C,EAAU4D,OAAOL,GAASM,SAC1BlD,EAAYrD,IAAI,IAAIG,YAAY,8BAIxCkD,EAAYrD,IAAI,IAAIG,YAAY,0BAIpC,OADAwG,GAAEuC,kBACK,KAIfxL,EAAE8C,KAAKyD,EAAejG,KAAK,mBAAoB,SAAU0L,EAAOxC,GAC5D,GAAIjB,GAAUvI,EAAEwJ,GACZsC,EAAOvD,EAAQpG,KAAK,YAExBnC,GAAE0H,MACEC,IAAKvB,EAAoB,gCACzBlD,KAAM,OACN0E,MACIkE,KAAMA,GAEV9D,QAAS,SAAUJ,GACf,GAAoB,gBAATA,GAAmB,CAC1B,GAAIQ,GAAQR,EAAK9D,OAAO,GAAGsE,MACvB6D,EAAajM,EAAE,WAEnBiM,GAAW5H,KAAK+D,EAAQ,KAAO0D,EAAO,KAAKxJ,IAAIwJ,EAAO,MAAQ1D,GAAOjG,MACjEqG,UAAY,EACZC,YAAaqD,IAGjBvD,EAAQI,SACR3D,EAAU4D,OAAOqD,GAAYpD,eAMzChD,EAAkB1C,OAAS,GAC3BnD,EAAE0H,MACEC,IAAKvB,EAAoB,gCACzBlD,KAAM,OACN0E,QACAI,QAAS,SAAUJ,GACf,GAA8C,mBAAnCA,GAAKsE,QAAQC,WAAWC,QAA6D,OAAnCxE,EAAKsE,QAAQC,WAAWC,OAAiB,CAClG,GAAIH,EAEJjM,GAAE8C,KAAK8E,EAAKsE,QAAQC,WAAWC,OAAQ,SAAUJ,EAAOxC,GACpDyC,EAAajM,EAAE,YAEfiM,EAAW5H,KAAKmF,EAAMwB,MAAM1I,IAAIkH,EAAM6C,UAAUlK,MAC5CmK,WAAY9C,EAAM6C,WAGtBxG,EAAkB+C,OAAOqD,GAErBpG,EAAkB1D,KAAK,gBAAkBqH,EAAM6C,UAC/CxG,EAAkBvD,IAAIkH,EAAM6C,YAKV,mBAAnBzE,GAAK2E,WAAgD,OAAnB3E,EAAK2E,YAC9C1G,EAAkB1D,KAAK,kBAAmByF,EAAK2E,WAG/C1G,EAAkB9D,GAAG,SAAU,WAC3B+D,EAAsB3D,KAAK,OAAQ,oCAAsC0D,EAAkB1D,KAAK,mBAAqB,eAAiB0D,EAAkBvF,KAAK,aAAa6B,KAAK,YAAc,WAIjM0D,EAAkBlD,QAAQ,cAM1C3C,EAAE,wBAAwB+E,MAAM,WAC5B,GAAIyH,GAAcxM,EAAE,sBAAwBA,EAAEiC,MAAME,KAAK,MAAQ,MAAMA,KAAK,MACxEsK,EAAmB7I,OAAO8I,cAW9B,OATAC,SAAQ,GAAI,8CAEZ/I,OAAO8I,eAAiB,SAAUtF,GAC9B,GAAIwF,GAAS5M,EAAE,MAAOoH,GAAMjF,KAAK,MACjCnC,GAAE,IAAMwM,GAAalK,IAAIsK,GAAQjK,QAAQ,UACzCkK,YACAjJ,OAAO8I,eAAiBD,IAGrB,IAGX7I,OAAO8I,eAAiB,SAAUtF,GAC9B,GAAIwF,GAAS5M,EAAE,MAAOoH,GAAMjF,KAAK,MACjCnC,GAAE,iBAAiBsC,IAAIsK,GACvBC,aAGJ9G,EAAahE,GAAG,qBAAsB,WAClC,GAAIC,GAAQhC,EAAEiC,MACV6K,EAAW9K,EAAM4H,SAAS,kBAC1BmD,EAA8B,KAAxB/M,EAAEoE,KAAKpC,EAAMM,OAAgBwK,EAAS3K,KAAK,oBAAsBH,EAAMM,KAEjFwK,GAAS3K,KAAK,MAAO4K,KAIzBhH,EAAapD,QAAQ,UAGrBqD,EAAcjE,GAAG,QAAS,WACtB/B,EAAEiC,MAAM2H,SAAS,sDAAsDrF,IAAI,aAAc,aAI7FvE,EAAE,SAASgN,cAGXhN,EAAE,sBAAsB+B,GAAG,QAAS,WAChC,GAAIyH,GAAQyD,SAAShL,KAAKuH,MAAM1B,QAAQ,UAAW,IACnD7F,MAAKuH,MAAQ0D,MAAM1D,GAAS,GAAKA,IAIrCxJ,EAAE,sBAAsB8C,KAAK,WACzB,GAAId,GAAQhC,EAAEiC,MACVuH,EAAkF,IAA1ExH,EAAM1B,KAAK,iBAAmB0B,EAAMG,KAAK,cAAgB,MAAMgB,OAAe,KAAOnB,EAAMG,KAAK,aAE5GH,GAAMM,IAAIkH,KAIdxJ,EAAE,qBAAqB+B,GAAG,SAAU,WAChC,GAAIC,GAAQhC,EAAEiC,MACVkL,EAAWnL,EAAMyC,QAAQ,aACzB2I,EAAQD,EAAS7M,KAAK,yBAEtB0B,GAAMM,MAAQ,EACd8K,EAAM1K,SAAS,QAEf0K,EAAM3K,YAAY,OAGtB,IAAI4K,GAAcF,EAAS7M,KAAK,uBAChC+M,GAAY1K,QAAQ,YAIxB3C,EAAE,8BAA8BsN,SAC5BC,aAAc,uBACdC,QAAS,SAAUC,GACfA,EAASzN,EAAEiC,MAAMoB,KAAK,SAASyE,QAAQ,SAAU,YAErD4F,UACIC,GAAI,kBACJC,GAAI,aACJC,UAAW,OACXC,MAAO,SAAUJ,EAAUK,GACvB/N,EAAEiC,MAAMsC,IAAImJ,GACZ1N,EAAE,SACG0C,SAAS,2BACTA,SAASqL,EAASC,UAClBtL,SAASqL,EAASE,YAClBC,SAASjM,UAO1BjC,EAAEmO,GAAGC,uBAAyB,WAC1B,GAAIpM,GAAQhC,EAAEiC,KAGVD,GAAMQ,SAAS,gCACfR,EAAMoF,KAAKpH,EAAE,SAAUA,EAAEiC,OAAOoF,KAAK,SAAUC,EAAGC,GAC9C,GAAIqG,GAAK5N,EAAEsH,GAAG+G,GAAG,gBAAkB,GAAKrO,EAAEsH,GAAGjD,OACzCiK,EAAKtO,EAAEuH,GAAG8G,GAAG,gBAAkB,GAAKrO,EAAEuH,GAAGlD,MAC7C,OAAQuJ,GAAKU,EAAM,EAAOV,EAAKU,KAAW,KAK9CtM,EAAM1B,KAAK,gBAAgB6B,KAAK,YAAY,KAKpDmE,EAAmBxD,KAAK,WACpB9C,EAAEiC,MAAMuE,WACJC,cAAe,SACfC,SAAS,EACTC,eAAe,EACfC,WAAW,EACXC,SAAU,KACVC,YAAa,iFACbC,UAAU,EACVC,2BAA2B,EAC3BC,YAAa,IACbC,OAAQlH,EAAEiC,MAAME,KAAK,oBAK7BnC,EAAE,qCAAqC8C,KAAK,WACxC,GAAId,GAAQhC,EAAEiC,KACdD,GAAMH,UAAUG,EAAMyC,QAAQ,6BAC9BzC,EAAM4H,SAAS,SAAS/H,UAAUG,EAAMyC,QAAQ,+BAQpDzE,EAAE,2DAA2DuJ,SACzDgF,wBAAyB,GACzBC,iBAAkB,sBAGtBxO,EAAE,2DAA2DuJ,SACzDgF,wBAAyB,GACzBC,iBAAkB,sBAGtBxO,EAAEmO,GAAGjE,cAAgB,SAAUuE,EAASC,GAEpCjO,EAASgC,YAAY,sDACrBhC,EAAS2G,KAAK,MAAQqH,EAAU,QAAQ/L,SAASgM,IAIrDrI,EAAsBtE,GAAG,SAAU,WAE/B,OAAIuD,EAAa+I,GAAG,aAAyC,KAA1B5I,EAAgBnD,QAC/CtC,EAAEiC,MAAMiI,cAAc,sDAAyD,WAC/ElK,EAAE4D,QAAQ+K,UAAU,IACb,KAMfC,iBACD1O,QACH,SAAWF,GACP4D,OAAOiL,UAAYjL,OAAOiL,cAE1BA,UAAUzO,MAAQ,KAClByO,UAAUpO,SAAW,KACrBoO,UAAUxO,MAAQ,KAClBwO,UAAUxB,YAAc,KACxBwB,UAAUC,iBACJtF,MAAQ,SAAUrB,MAAQ,UAAW4G,QAAU,kBAC/CvF,MAAQ,SAAUrB,MAAQ,UAAW4G,QAAU,eAC/CvF,MAAQ,QAASrB,MAAQ,QAAS4G,QAAU,YAC5CvF,MAAQ,WAAYrB,MAAQ,WAAY4G,QAAU,qBAClDvF,MAAQ,SAAUrB,MAAQ,SAAU4G,QAAU,cAC9CvF,MAAQ,aAAcrB,MAAQ,kBAAmB4G,QAAU,YAC3DvF,MAAQ,SAAUrB,MAAQ,SAAU4G,QAAU,cAC9CvF,MAAQ,UAAWrB,MAAQ,UAAW4G,QAAU,eAChDvF,MAAQ,YAAarB,MAAQ,YAAa4G,QAAU,iBACpDvF,MAAQ,cAAerB,MAAQ,cAAe4G,QAAU,mBAE9DF,UAAUG,yBACJxF,MAAQ,SAAUrB,MAAQ,UAAW4G,QAAU,kBAC/CvF,MAAQ,SAAUrB,MAAQ,UAAW4G,QAAU,eAC/CvF,MAAQ,QAASrB,MAAQ,QAAS4G,QAAU,YAC5CvF,MAAQ,WAAYrB,MAAQ,WAAY4G,QAAU,qBAClDvF,MAAQ,SAAUrB,MAAQ,SAAU4G,QAAU,cAC9CvF,MAAQ,aAAcrB,MAAQ,kBAAmB4G,QAAU,YAC3DvF,MAAQ,SAAUrB,MAAQ,SAAU4G,QAAU,cAC9CvF,MAAQ,UAAWrB,MAAQ,UAAW4G,QAAU,eAChDvF,MAAQ,YAAarB,MAAQ,YAAa4G,QAAU,iBACpDvF,MAAQ,cAAerB,MAAQ,cAAe4G,QAAU,mBACxDvF,MAAQ,YAAarB,MAAQ,qBAAsB4G,QAAU,SAC7DvF,MAAQ,eAAgBrB,MAAQ,yBAA0B4G,QAAU,SACpEvF,MAAQ,YAAarB,MAAQ,qBAAsB4G,QAAU,SAC7DvF,MAAQ,eAAgBrB,MAAQ,yBAA0B4G,QAAU,SACpEvF,MAAQ,YAAarB,MAAQ,qBAAsB4G,QAAU,SAC7DvF,MAAQ,eAAgBrB,MAAQ,yBAA0B4G,QAAU,SAE1EF,UAAUI,yBACJzF,MAAQ,QAASrB,MAAQ,gBAAiB4G,QAAU,QACpDvF,MAAQ,YAAarB,MAAQ,aAAc4G,QAAU,MACrDvF,MAAQ,UAAWrB,MAAQ,WAAY4G,QAAU,OAEvDF,UAAUK,wBACJ1F,MAAQ,OAAQrB,MAAQ,cAAe4G,QAAU,sBAGvD/O,EAAEmO,GAAGgB,cAAgB,SAAUC,GAC3B,GAAIpN,GAAQhC,EAAEiC,MACVoN,EAAQrN,EAAMqB,KAAK,kBACnBiM,EAAMtN,EAAMqB,KAAK,gBACjBgB,EAAOrC,EAAMM,MACbiN,EAASlL,EAAKN,UAAU,EAAGsL,GAC3BG,EAASnL,EAAKN,UAAUuL,EAAKjL,EAAKlB,OAEtCnB,GAAMM,IAAIiN,EAASH,EAAUI,GAC7BxN,EAAM,GAAGyN,eAAiBzN,EAAM,GAAG0N,aAAeL,EAAQD,EAAQjM,OAClEnB,EAAMsJ,SAGVtL,EAAEmO,GAAGwB,gBAAkB,SAAUC,GAC7B,GAAI5N,GAAQhC,EAAEiC,KAEdD,GAAMsI,cACFC,OAAQqF,EACR3E,UAAW,EACXC,KAAM,WACFlL,EAAEiC,MAAM2F,KAAK,kBAAkBuD,KAAKC,QAAQ1I,SAAS,2BAEzD4I,MAAO,SAASC,GACZA,EAAMC,kBAEVC,OAAQ,SAASF,EAAOG,GAEpB,MADA1J,GAAMmN,cAAczD,EAAGZ,KAAKtB,MAAQ,MAC7B,GAEXqG,YAAa,SAASC,EAAIhF,GACtB,MAAO9K,GAAE,QAAQ4I,OAAOkC,EAAK3C,OAAO+F,SAAS4B,MAIrD9N,EAAMD,GAAG,UAAW,SAASkH,GACzB,GAAe,KAAZA,EAAEC,MACD,OAAO,IAIflH,EAAMD,GAAG,QAAS,SAASkH,GACpBA,EAAE8G,UAAwB,KAAZ9G,EAAEC,OACflH,EAAMsI,aAAc,SAAU,MAItCtI,EAAMD,GAAG,qBAAsB,WAC3B,GAGIiO,GACAC,EAJAzG,EAAQxH,EAAMM,MACd4N,EAAWlO,EAAMyC,QAAQ,aACzBoF,EAAgB7H,EAAMyC,QAAQ,mBAI5ByL,EAAS/M,SAAW0G,EAAc1G,QAAWnB,EAAMQ,SAAS,gBAIlEwN,EAAeE,EAAS5P,KAAK,qBAAqBgC,MAAQ,EAE1DtC,EAAE8C,KAAK8M,EAAS,SAAS5D,EAAOmE,GAC5BF,EAAQ,GAAIG,QAAO,IAAMD,EAAI3G,MAAQ,IAAI,KACzCA,EAASA,EAAM1B,QAAQmI,EAAOE,EAAIpB,WAGtC/M,EAAMyC,QAAQ,aAAanE,KAAK,wBAAwB8G,KAAM,8BAAgC4I,EAAehQ,EAAE,0BAA0BoH,OAAU,IAAMoC,EAAO,WAChKxH,EAAMyC,QAAQ,kBAAkBnE,KAAK,wBAAwB8G,KAAM,6BAA+BoC,EAAQ,cAG9GxH,EAAMD,GAAG,OAAQ,WACb,GAAIC,GAAQhC,EAAEiC,KAEa,MAAxBjC,EAAEoE,KAAKpC,EAAMM,QAAiBN,EAAM4F,KAAK,YACxC5F,EAAMM,IAAIN,EAAM4F,KAAK,YAIpB,MAAMmE,KAAK/J,EAAMM,QAAUN,EAAM4F,KAAK,wBACvC5F,EAAMM,IAAKN,EAAMM,MAAMwF,QAAS,UAAW,MAG/C9F,EAAMW,QAAQ,YAGlBX,EAAMW,QAAQ,SAGlB3C,EAAEmO,GAAGkC,mBAAqB,WACtBxB,UAAUzO,MAAQ6B,KAClB4M,UAAUpO,SAAWoO,UAAUzO,MAAME,KAAK,YAC1CuO,UAAUxO,MAAQwO,UAAUzO,MAAME,KAAK,4BACvCuO,UAAUxB,YAAcwB,UAAUzO,MAAME,KAAK,wBAC7CuO,UAAUyB,iBAAmBtQ,EAAE,gCAC/B6O,UAAU0B,gBAAkBvQ,EAAE,+BAC9B6O,UAAU2B,cAAgBxQ,EAAE,4CAC5B6O,UAAU4B,gBAAkBzQ,EAAE,0BAC9B6O,UAAU6B,WAAa1Q,EAAE,8BACzB6O,UAAU8B,qBAAuB3Q,EAAE,0CACnC6O,UAAU+B,gBAAkB5Q,EAAE,oDAC9B6O,UAAUgC,sBAAwB7Q,EAAE,iDAEpC,IAAI8Q,GAA2B,WAC3B,GAAI9O,GAAQhC,EAAEiC,MACV2N,EAAU5N,EAAMQ,SAAS,oBAAsB,yBAA2B,gBAC9ER,GAAM2N,gBAAgBd,UAAUe,IAIpC5P,GAAE8C,KAAK+L,UAAUxB,YAAayD,GAG9BjC,UAAUyB,iBAAiBX,gBAAgBd,UAAUI,wBACrDJ,UAAU0B,gBAAgBZ,gBAAgBd,UAAUK,uBAGpDL,UAAU4B,gBAAgB1O,GAAG,qBAAsB,WAC/C,GAAIC,GAAQhC,EAAEiC,MACV6K,EAAW9K,EAAM4H,SAAS,kBAC1BmD,EAA8B,KAAxB/M,EAAEoE,KAAKpC,EAAMM,OAAgBwK,EAAS3K,KAAK,oBAAsBH,EAAMM,KAEjFwK,GAAS3K,KAAK,MAAO4K,KAIzB8B,UAAU+B,gBAAgB7O,GAAG,QAAS,WAClC8M,UAAU+B,gBAAgBlO,SAAS,QACnCmM,UAAUgC,sBAAsBpO,YAAY,QAE5CzC,EAAE0H,MACEC,IAAK,oDACLzE,KAAM,OACN0E,MACImJ,MAAOlC,UAAU8B,qBAAqBxN,QAE1C6E,QAAS,SAAUJ,GACfiH,UAAU6B,WAAW9H,OAAOhB,GAC5BiH,UAAU+B,gBAAgBnO,YAAY,QACtCoM,UAAUgC,sBAAsBnO,SAAS,OAEzC,IAAItC,GAAQyO,UAAU6B,WAAWpQ,KAAK,6BAClCI,EAAWN,EAAME,KAAK,+BACtB+M,EAAcjN,EAAME,KAAK,wBACzB0Q,EAAa5Q,EAAME,KAAK,sBAE5BN,GAAE8C,KAAKuK,EAAayD,GAEpBpQ,EAASqB,GAAG,QAAS,WACjB,GAAIC,GAAQhC,EAAEiC,MACVuC,EAAiBxC,EAAMyC,QAAQ,gCAC/BC,EAAgBF,EAAelE,KAAK,oBACpCqE,EAAiBH,EAAelE,KAAK,+BAEJ,UAAlCqE,EAAeJ,IAAI,YAClBI,EAAeC,YACfF,EAAchC,SAAS,QACvBV,EAAMU,SAAS,UAEfiC,EAAeE,UACfH,EAAcjC,YAAY,QAC1BT,EAAMS,YAAY,WAI1BzC,EAAE8C,KAAKkO,EAAY,WACfC,SAAWjR,EAAEiC,MAAMsH,SAAS2H,MAAO,SAEhCD,SAASrJ,KAAK,WAAWuJ,UACxBF,SAASrJ,KAAK,WAAWuJ,UAAUzO,SAAS,0BACtCuO,SAASrJ,KAAK,WAAWwJ,UAC/BH,SAASrJ,KAAK,WAAWwJ,SAAS1O,SAAS,4BAInDtC,EAAME,KAAK,wBAAwByB,GAAG,QAAS,WAC3C,GAAIsP,GAAajR,EAAME,KAAK,sBAAwBN,EAAEiC,MAAME,KAAK,MAAQ,MACrEsK,EAAmB7I,OAAO8I,cAmB9B,OAjBAC,SAAQ,GAAI,8CAEZ0E,EAAWtP,GAAG,qBAAsB,WAChC,GAAIC,GAAQhC,EAAEiC,MACV6K,EAAW9K,EAAM4H,SAAS,kBAC1BmD,EAA8B,KAAxB/M,EAAEoE,KAAKpC,EAAMM,OAAgBwK,EAAS3K,KAAK,oBAAsBH,EAAMM,KAEjFwK,GAAS3K,KAAK,MAAO4K,KAGzBnJ,OAAO8I,eAAiB,SAAUtF,GAC9B,GAAIwF,GAAS5M,EAAE,MAAOoH,GAAMjF,KAAK,MACjCkP,GAAW/O,IAAIsK,GAAQjK,QAAQ,UAC/BkK,YACAjJ,OAAO8I,eAAiBD,IAGrB,SAQvBoC,UAAUxO,MAAM0B,GAAG,SAAU,WACzB,GAAIqI,IAAQ,CAGZyE,WAAUzO,MAAME,KAAK,kCAAkCwC,KAAK,WACxD,GAAId,GAAQhC,EAAEiC,MACVqP,EAAUtP,EAAMM,MAChBiP,EAAOvP,EAAMyC,QAAQ,sCAAsCnE,KAAK,qBAChEkR,EAAuB,GAAIpB,QAAO,gBAClCqB,EAAe,GACfC,EAAUzE,SAASsE,EAAKjP,MAc5B,IAZIoP,EAAU,EACN,WAAW3F,KAAKuF,MAAa,EAC7BG,EAAe,8HACRD,EAAqBzF,KAAKuF,MAAa,EAC9CG,EAAe,kDACR,MAAM1F,KAAKuF,MAAa,IAC/BG,EAAe,0CAEZC,QAAkBF,EAAqBzF,KAAKuF,MAAa,IAChEG,EAAe,+CAGfA,EAKA,MAJA5C,WAAUpO,SAASiC,SAAS,WAAWD,YAAY,QACnDoM,UAAUpO,SAASH,KAAK,KAAK+D,KAAKoN,GAClC5C,UAAUzO,MAAME,KAAK,8BAA8BqC,QAAQ,SAC3DyH,GAAQ,GACD,IAKfyE,UAAUzO,MAAME,KAAK,8BAA8BwC,KAAK,WACpD,GAAId,GAAQhC,EAAEiC,MACV0P,EAAiB3P,EAAM1B,KAAK,yBAAyBgC,MAErDmP,GADuBzP,EAAM1B,KAAK,wBAAwBgC,MAC3C,GAQnB,IAN6B,KAAzBqP,EAAcvN,OACdqN,EAAe,qCACiB,KAAzBE,EAAcvN,SACrBqN,EAAe,sCAGfA,EAKA,MAJA5C,WAAUpO,SAASiC,SAAS,WAAWD,YAAY,QACnDoM,UAAUpO,SAASH,KAAK,KAAK+D,KAAKoN,GAClC5C,UAAUzO,MAAME,KAAK,uCAAuCqC,QAAQ,SACpEyH,GAAQ,GACD,GAMf,IAAIkH,GAAUzC,UAAU2B,cAAclO,MAClCkP,EAAuB,GAAIpB,QAAO,gBAClCqB,EAAe,EAiBnB,IAfI,WAAW1F,KAAKuF,MAAa,EAC7BG,EAAe,6HACRD,EAAqBzF,KAAKuF,MAAa,EAC9CG,EAAe,iDACR,MAAM1F,KAAKuF,MAAa,IAC/BG,EAAe,yCAGfA,IACA5C,UAAUpO,SAASiC,SAAS,WAAWD,YAAY,QACnDoM,UAAUpO,SAASH,KAAK,KAAK+D,KAAKoN,GAClC5C,UAAUzO,MAAME,KAAK,4BAA4BqC,QAAQ,SACzDyH,GAAQ,GAGTA,KAAU,EAET,MADAxG,QAAOkB,SAAS,EAAG,IACZ,KAMnB9E,EAAE,WACEA,EAAE,+BAA+BqQ,wBAEtCnQ","file":"scripts.min.js","sourcesContent":["(function($) {\n    var $supapressJQuery = jQuery.noConflict(),\n        $wrap = $supapressJQuery('.supapress-wrap'),\n        $form = $wrap.find('#supapress-add-edit-form'),\n        $step1 = $wrap.find('#step1'),\n        $step2 = $wrap.find('#step2'),\n        $message = $wrap.find('#message'),\n        $element = $wrap.find('.supapress-accordion-header'),\n        $selector = $wrap.find('.elements.nav-tab-content .selector'),\n        $step1NextButton = $wrap.find(\"#step1_next_btn\"),\n        $widgetTitleWrapper = $wrap.find(\".widget-title-wrapper\"),\n        $widgetTypeWrapper = $wrap.find('.widget-type-wrapper'),\n        $widgetTitle = $widgetTitleWrapper.find(\"#widget-title\"),\n        $widgetLayout = $wrap.find('input[name=\"widget_layout\"]'),\n        $subContentSwitch = $wrap.find('.sub-content-toggle'),\n        $navTab = $wrap.find(\".nav-tab\"),\n        $navTabContent = $wrap.find(\".nav-tab-content\"),\n        $layoutContent = $wrap.find(\".layout-content\"),\n        $isbnLookupSource = $wrap.find(\"#lookup_source\"),\n        $isbnLookupBulk = $wrap.find(\"#isbn_lookup_bulk\"),\n        $isbnLookupSourceInputs = $wrap.find(\".lookup-source-input\"),\n        $saveButtonWrapper = $wrap.find('.save-button-wrapper'),\n        fadeIn = true,\n        fadeOut = true,\n        typeParameter = '',\n        step2positioning = function() {\n            $widgetTypeWrapper.prependTo($step2);\n            $widgetTitleWrapper.prependTo($step2).find('p').hide();\n\n            $widgetTypeWrapper.find('input').on('change', function() {\n                var $this = $(this),\n                    $label = $widgetTypeWrapper.find('label[for=\"' + $this.attr('id') + '\"]');\n\n                $label.prependTo($label.parent());\n                $this.prependTo($this.parent());\n\n                // Set tabs\n                setTabs($widgetTypeWrapper.find('input:checked').val());\n\n                // Change tab content\n                setNavContent($navTabContent, $supapressJQuery('.nav-tab-active').attr('data-tab'));\n\n                // Change layout content\n                setNavContent($layoutContent, $supapressJQuery('.widget-layout-wrapper').find('input:checked').attr('data-sub-tab'));\n            });\n\n            $widgetTypeWrapper.find('input').on('click', function() {\n                if($widgetTypeWrapper.hasClass('open')) {\n                    $widgetTypeWrapper.removeClass('open');\n                } else {\n                    $widgetTypeWrapper.addClass('open');\n                }\n            });\n\n            $widgetTypeWrapper.find('input:checked').trigger('change');\n\n            // Set tabs\n            setTabs($widgetTypeWrapper.find('input:checked').val());\n\n            // Change tab content\n            setNavContent($navTabContent, $supapressJQuery('.nav-tab-active').attr('data-tab'));\n\n            // Change layout content\n            setNavContent($layoutContent, $supapressJQuery('.widget-layout-wrapper').find('input:checked').attr('data-sub-tab'));\n        },\n        setNavContent = function($container, selector) {\n            // Loop content wrappers and show the one matching the click tabs data value\n            $container.each(function() {\n                var $this = $(this);\n\n                // If the tab value is found show content\n                if($this.hasClass(selector) && !$this.hasClass('sub-content-wrapper')) {\n                    if(selector === 'elements') {\n                        $selector.find('.supapress-field-wrapper').each(function() {\n                            var $elem = $(this);\n\n                            if(!$elem.hasClass('all-tabs') && !$elem.hasClass($widgetTypeWrapper.find('input:checked').val())) {\n                                $elem.hide().find('input:checked').attr('checked', false);\n                            } else {\n                                $elem.show();\n                            }\n                        });\n                    } else if(selector === 'arrangement') {\n                        $this.find('.widget-layout-wrapper-inner').each(function() {\n                            var $elem = $(this);\n\n                            if($elem.hasClass($widgetTypeWrapper.find('input:checked').val())) {\n                                $elem.show();\n                            } else {\n                                $elem.hide();\n                            }\n                        });\n                    }\n\n                    $this.show();\n                } else {\n                    $this.hide();\n                }\n            });\n\n            // Hide elements not specific to widget type\n            $('.widget-type-specific').each(function() {\n                var $elem = $(this);\n\n                if($elem.hasClass($widgetTypeWrapper.find('input:checked').val())) {\n                    $elem.show();\n\n                    if($elem.hasClass('custom_layout_file')) {\n                        $elem.find('select').removeAttr('disabled');\n                    }\n                } else {\n                    $elem.hide();\n\n                    if($elem.hasClass('custom_layout_file')) {\n                        $elem.find('select').attr('disabled', 'disabled');\n                    }\n                }\n            });\n            \n            // Temporary hack to hide all carousel elements when the widget is not isbn_lookup\n            if($widgetTypeWrapper.find('input:checked').val() !== 'isbn_lookup') {\n                $wrap.find('.carousel.layout-content').hide();\n\n                if($supapressJQuery('.widget-layout-wrapper').find('input:checked').val() === 'carousel') {\n                    $wrap.find('#widget_layout1').trigger('click');\n                }\n            }\n\n            // Turn fade in off as trigger comes from tab change\n            fadeIn = false;\n            // Turn fade out off when switching between module types\n            fadeOut = false;\n\n            // Trigger change to set on page load\n            $subContentSwitch.trigger('change');\n\n            // Turn fade out back on so it works when you click on/off element switches\n            fadeOut = true;\n        },\n        setTabs = function(type) {\n            if(type === 'product_details') {\n                // show arrangement if there are custom templates\n                if(!$wrap.find('.custom_layout_file.product_details').length) {\n                    $wrap.find('.nav-tab[data-tab=\"content\"], .nav-tab[data-tab=\"arrangement\"]').removeClass('nav-tab-active').hide();\n                    $widgetLayout.filter('[value=\"grid\"]').prop('checked', true);\n                } else {\n                    $wrap.find('.nav-tab[data-tab=\"content\"]').removeClass('nav-tab-active').hide();\n                    $wrap.find('.nav-tab[data-tab=\"arrangement\"]').removeClass('nav-tab-active').show();\n                    $widgetLayout.filter('[value=\"custom\"]').prop('checked', true);\n                }\n                $wrap.find('.nav-tab[data-tab=\"elements\"]').addClass('nav-tab-active').show();\n                $wrap.find('.nav-tab[data-tab=\"restrictions\"]').hide();\n            } else if(type === 'search_results') {\n                $wrap.find('.nav-tab').removeClass('nav-tab-active').show();\n                $wrap.find('.nav-tab[data-tab=\"content\"], .nav-tab[data-tab=\"seo\"]').hide();\n                $wrap.find('.nav-tab[data-tab=\"restrictions\"]').show();\n                $wrap.find('.nav-tab[data-tab=\"elements\"]').addClass('nav-tab-active');\n            } else {\n                $wrap.find('.nav-tab').removeClass('nav-tab-active').show();\n                $wrap.find('.nav-tab[data-tab=\"seo\"], .nav-tab[data-tab=\"restrictions\"]').hide();\n                $wrap.find('.nav-tab[data-tab=\"content\"]').addClass('nav-tab-active');\n            }\n        },\n        getUrlParameter = function getUrlParameter(sParam) {\n            var sPageURL = decodeURIComponent(window.location.search.substring(1)),\n                sURLVariables = sPageURL.split('&'),\n                sParameterName,\n                i;\n\n            for (i = 0; i < sURLVariables.length; i++) {\n                sParameterName = sURLVariables[i].split('=');\n\n                if (sParameterName[0] === sParam) {\n                    return sParameterName[1] === undefined ? '' : sParameterName[1];\n                }\n            }\n        };\n\n    // Add click events to navigation tabs\n    $navTab.on('click', function() {\n        var $navTabClicked = $(this),\n            saveButtonWrapperHidden = $saveButtonWrapper.hasClass('hide');\n\n        // Remove and add new active class\n        $navTab.removeClass('nav-tab-active');\n        $navTabClicked.addClass('nav-tab-active');\n\n        // Change tab content\n        setNavContent($navTabContent, $navTabClicked.attr('data-tab'));\n    });\n\n    // Add change event to layout selector\n    $widgetLayout.on('change', function() {\n        // Change tab content\n        setNavContent($layoutContent, $(this).attr('data-sub-tab'));\n    });\n\n    // Trigger change to set on page load\n    setNavContent($layoutContent, $('input[name=\"widget_layout\"]:checked').attr('data-sub-tab'));\n\n    // Add change event to lookup source to show / hide relevant inputs\n    $isbnLookupSource.on('change', function() {\n        $isbnLookupSourceInputs.each(function() {\n            var $this = $(this);\n\n            // If the lookup source value is found show input\n            if($this.hasClass($isbnLookupSource.val())) {\n                $this.show();\n            } else {\n                $this.hide();\n            }\n        });\n    });\n\n    // Trigger change to set on page load\n    $isbnLookupSource.trigger('change');\n\n    // Add click event to next button follow widget title and type selection\n    $step1NextButton.on('click', function() {\n        if($.trim($widgetTitle.val()) === '') {\n            $message.addClass('warning').removeClass('hide');\n            $message.find('p').text('Please enter a name for your widget');\n        } else {\n            $step1.hide();\n            $step2.show();\n            $message.addClass('hide');\n\n            step2positioning();\n        }\n    });\n\n    // On toggle switch show / hide attached sub content\n    $subContentSwitch.on('change', function() {\n        var $this = $(this),\n            $content = $('div.' + $this.attr('data-sub-content'));\n\n        if($this.prop('checked') && ($content.hasClass($('input[name=\"widget_layout\"]:checked').attr('data-sub-tab')) || $content.hasClass('tab-level'))) {\n            if($content.css('display') === 'none' && fadeIn) {\n                $content.fadeIn();\n            } else {\n                $content.show();\n            }\n        } else {\n            if($content.css('display') !== 'none' && fadeOut) {\n                $content.fadeOut();\n            } else {\n                $content.hide();\n            }\n        }\n\n        // Reset to fade in\n        fadeIn = true;\n    });\n\n    // Show / Hide the config settings for the element\n    $element.on('click', function() {\n        var $this = $(this),\n            $elementParent = $this.parents('.supapress-accordion-wrapper'),\n            $elementArrow = $elementParent.find('.svg-right-arrow'),\n            $elementConfig = $elementParent.find('.supapress-accordion-content');\n\n        if($elementConfig.css('display') === 'none') {\n            $elementConfig.slideDown();\n            $elementArrow.addClass('open');\n            $this.addClass('open');\n        } else {\n            $elementConfig.slideUp();\n            $elementArrow.removeClass('open');\n            $this.removeClass('open');\n        }\n    });\n\n    // Catch form submit for validation checks\n    $form.on('submit', function() {\n        if($.trim($widgetTitle.val()) === '') {\n            $message.addClass('warning').removeClass('hide');\n            $message.find('p').text('Please enter a name for your widget');\n            return false;\n        } else if($wrap.find('.elements.nav-tab-content .selector input:checked').length === 0) {\n            // Set message\n            $message.addClass('warning').removeClass('hide');\n            $message.find('p').text('Please choose at least one element to display in your widget.');\n            $wrap.find('.nav-tab[data-tab=\"elements\"]').trigger('click');\n            // Block the submission and scroll to the top to display the warning\n            window.scrollTo(0, 0);\n            return false;//\n        } else if($widgetTypeWrapper.find('input:checked').val() !== 'product_details' && !$('input[name=\"widget_layout\"]:checked').parents('.widget-layout-wrapper-inner').hasClass($widgetTypeWrapper.find('input:checked').val())) {\n            // 'product_details' check is  temporary until product details has multiple layouts\n            // Set message\n            $message.addClass('warning').removeClass('hide');\n            $message.find('p').text('Please choose how to display your widget (e.g. Grid or List)');\n            $wrap.find('.nav-tab[data-tab=\"arrangement\"]').trigger('click');\n            // Block the submission and scroll to the top to display the warning\n            window.scrollTo(0, 0);\n            return false;\n        } else if ($widgetTypeWrapper.find('input:checked').val() === 'isbn_lookup' && $isbnLookupSource.val() === 'bulk' &&  $isbnLookupBulk.val() !== '' ) {\n            $message.addClass('warning').removeClass('hide');\n            $message.find('p').text('Please use the \"Add ISBN(s)\" button to add your entered ISBN(s) to the list.');\n            $wrap.find('.nav-tab[data-tab=\"content\"]').trigger('click');\n            // Block the submission and scroll to the top to display the warning\n            window.scrollTo(0, 0);\n            return false;\n        } else if($('input[name=\"widget_layout\"]:checked').val() === 'custom' && !$('#custom_layout_file_' + $('input[name=\"widget_type\"]:checked').val()).val()) {\n            // make sure there is a template selected when Custom is chosen as the layout\n            // Set message\n            $message.addClass('warning').removeClass('hide');\n            $message.find('p').text('Please select a template for your custom layout');\n            $wrap.find('.nav-tab[data-tab=\"arrangement\"]').trigger('click');\n            // Block the submission and scroll to the top to display the warning\n            window.scrollTo(0, 0);\n            return false;\n        }\n    });\n\n    // On page load if edit page go to step 2\n    if($wrap.hasClass('edit')) {\n        // Update heading positions\n        step2positioning();\n    }\n\n    // If linked from widget settings type will have been selected already so we need to go straight to step 2\n    typeParameter = getUrlParameter('type');\n    if(typeParameter) {\n        $widgetTypeWrapper.find('input[value=\"' + typeParameter + '\"]').click();\n        $step1.hide();\n        $step2.show();\n        $message.addClass('hide');\n\n        step2positioning();\n    }\n})(jQuery);\n\n(function ($) {\n    var $supapressJQuery = jQuery.noConflict(),\n        $isbnList = $supapressJQuery(\"#isbn_list\"),\n        $price = $supapressJQuery(\"#price\"),\n        $retailerLinks = $supapressJQuery(\"#retailer_links\"),\n        $message = $supapressJQuery(\"#message\"),\n        $filters = $supapressJQuery(\"#filters\"),\n        $sortBy = $supapressJQuery(\"#sort_by\"),\n        $perPage = $supapressJQuery(\"#per_page\"),\n        $showPerPage = $supapressJQuery(\"#show_per_page\"),\n        $perPageInput = $supapressJQuery(\"#per_page_input\"),\n        $perPageInputButton = $supapressJQuery(\"#per_page_input_btn\"),\n        $perPageDefault = $supapressJQuery(\"#per_page_default\"),\n        $asmIsbnLookup = $('.supapress-isbn-lookup-asm'),\n        $isbnLookup = $supapressJQuery(\"#isbn_lookup\"),\n        $isbnLookupLabel = $supapressJQuery(\"#isbn_lookup_label\"),\n        $lookupCollection = $supapressJQuery('#lookup_collection'),\n        $editCollectionButton = $supapressJQuery('.edit-collection-button'),\n        $arrowUpload = $supapressJQuery('.arrow-upload, .placeholder-upload'),\n        $arrowPreview = $supapressJQuery('.show-arrows .image-preview, .lazy-load .image-preview'),\n        $clearCacheButton = $supapressJQuery(\"#supapress-clear-cache-button\"),\n        $addBulkISBNsButton = $supapressJQuery(\"#supapress-add-bulk-isbns-button\"),\n        $addBulkISBNs = $supapressJQuery(\"#isbn_lookup_bulk\"),\n        isbnLookupAjaxUrl = $isbnLookup.attr('data-ajax-url'),\n        $supapressAddEditForm = $supapressJQuery('#supapress-add-edit-form'),\n        $searchFilterLists = $supapressJQuery(\".supapress-search-restriction-list\");\n\n    var $isbnContainer = $isbnList.asmSelect({\n        addItemTarget: 'bottom',\n        animate: false,\n        hideWhenAdded: true,\n        highlight: true,\n        listType: 'ul',\n        selectClass: 'supapress-isbn-lookup-asm',\n        sortable: true,\n        highlightOutsideContainer: true,\n        removeLabel: 'x',\n        svgUrl: $isbnList.attr('data-svg-url')\n    });\n\n    $isbnLookupLabel.insertBefore($asmIsbnLookup);\n    $isbnLookup.insertBefore($asmIsbnLookup);\n\n    // Set price ASM select\n    $price.html($(\"option\", $price).sort(function (a, b) {\n        var arel = $(a).attr('rel');\n        var brel = $(b).attr('rel');\n        return arel == brel ? 0 : arel < brel ? -1 : 1;\n    }));\n\n    $price.asmSelect({\n        addItemTarget: 'bottom',\n        animate: false,\n        hideWhenAdded: true,\n        highlight: true,\n        listType: 'ul',\n        selectClass: 'supapress-dropdown supapress-price-locale-asm supapress-reorder-dropdown',\n        sortable: true,\n        highlightOutsideContainer: false,\n        removeLabel: 'x',\n        svgUrl: $isbnList.attr('data-svg-url')\n    });\n    \n    // Set retailer links ASM select\n    $retailerLinks.html($(\"option\", $retailerLinks).sort(function (a, b) {\n        var arel = $(a).attr('rel');\n        var brel = $(b).attr('rel');\n        return arel == brel ? 0 : arel < brel ? -1 : 1;\n    }));\n\n    $retailerLinks.asmSelect({\n        addItemTarget: 'bottom',\n        animate: false,\n        hideWhenAdded: true,\n        highlight: true,\n        listType: 'ul',\n        selectClass: 'supapress-dropdown supapress-retailer-link-asm supapress-reorder-dropdown',\n        sortable: true,\n        highlightOutsideContainer: false,\n        removeLabel: 'x',\n        svgUrl: $isbnList.attr('data-svg-url')\n    });\n\n    // Look through ISBNs entered by user and add if okay\n    $addBulkISBNsButton.on('click', function () {\n        $.ajax({\n            url: 'admin-ajax.php?action=supapress_bulk_isbn_lookup',\n            type: 'POST',\n            data: {\n                ISBNs: $addBulkISBNs.val().replace(/\\n/g, ',').replace(/ /g, '').replace(/,+/g, ',')\n            },\n            dataType: 'json',\n            success: function (data) {\n                for (var isbn13 in data.ISBNs) {\n                    var book = data.ISBNs[isbn13],\n                        label = book.title + ' (' + isbn13 + ')',\n                        key = isbn13 + '|||' + book.title,\n                        $existingOption = $isbnList.find('option[data-isbn=\"' + isbn13 + '\"]:selected'),\n                        $option = $(\"<option>\").text(label).val(key).attr({\n                            \"selected\": true,\n                            \"data-isbn\": isbn13\n                        });\n\n                    if (book.found === -1) {\n                        $option.addClass('book-not-found');\n                    }\n\n                    if ($existingOption.length === 1) {\n                        $existingOption.remove();\n                    }\n\n                    $isbnList.append($option);\n                }\n\n                $isbnList.change();\n                $addBulkISBNs.val('');\n            }\n        });\n    });\n\n    // Click the per page search filter\n    $perPageInputButton.on('click', function () {\n        var number = $(\"#per_page_input\").val();\n\n        if (number > 100 || number < 1) {\n            alert('Number should be between 1 and 100');\n        } else if ($(\"#per_page option:selected[value='\" + number + \"']\").length) {\n            alert(number + ' has already been set');\n        } else if (number) {\n            $perPageDefault.append($(\"<option></option>\").text(number).attr(\"value\", number));\n            $perPage.append($(\"<option></option>\").text(number).attr(\"selected\", true).attr(\"value\", number)).change();\n        }\n\n        $perPageInput.val('');\n\n        return false;\n    });\n\n    // Allow <enter> to run adding new per page option\n    $perPageInput.keypress(function (e) {\n        if (e.which == 13) {\n            $perPageInputButton.click();\n            return false;\n        }\n    });\n\n    $perPage.asmSelect({\n        addItemTarget: 'bottom',\n        animate: false,\n        hideWhenAdded: true,\n        highlight: true,\n        listType: 'ul',\n        selectClass: 'hide',\n        sortable: true,\n        highlightOutsideContainer: false,\n        removeLabel: 'x',\n        svgUrl: $isbnList.attr('data-svg-url')\n    });\n\n    // Redo the default per page options when change to the per page options\n    $('body').on('change', '#per_page', function () {\n        var $perPageSelectedOptions = $perPage.children(\"option:selected\");\n        var $perPageDefaultSelectedOptions = $perPageDefault.children(\"option\");\n\n        // If no change, return\n        if ($perPageSelectedOptions.length === $perPageDefaultSelectedOptions.length) {\n            return false;\n        }\n\n        // Get current set default value for use later\n        var currentPerPageDefaultValue = $perPageDefault.select2(\"val\");\n\n        // Sort the values into the order we want\n        $perPageSelectedOptions.sort(function (a, b) {\n            a = a.value;\n            b = b.value;\n            return a - b;\n        });\n\n        // Reset dropdown with the default value\n        $perPageDefault.empty().append($(\"<option>\").text(\"No default set\").val(\"\"));\n\n        // Loop through the new ordered values and add to options, selecting if old selected still there\n        $perPageSelectedOptions.each(function () {\n            var newOption = $(\"<option>\").text($(this).val()).val($(this).val());\n            if (currentPerPageDefaultValue === $(this).val()) {\n                newOption.attr(\"selected\", true);\n            }\n            $perPageDefault.append(newOption);\n        });\n\n        // Set value to \"No default set\" when no value set in previous .each, warning if there was a value before\n        if (!$perPageDefault.select2(\"val\")) {\n            // Below is required as the dropdown doesn't highlight correctly if nothing set\n            $perPageDefault.select2(\"val\", \"\");\n            if (currentPerPageDefaultValue) {\n                alert('You have removed the set default value');\n            }\n        }\n    });\n\n    // Set sort by ASM select\n    $perPage.html($(\"option\", $perPage).sort(function (a, b) {\n        var arel = $(a).attr('rel');\n        var brel = $(b).attr('rel');\n        return arel == brel ? 0 : arel < brel ? -1 : 1;\n    }));\n\n    // Move dropdown out of container\n    var $priceLocale = $('.supapress-price-locale-asm');\n    $priceLocale.prependTo($priceLocale.parents('.supapress-field-wrapper'));\n    $priceLocale.siblings('label').prependTo($priceLocale.parents('.supapress-field-wrapper'));\n    \n    var $retailerLink = $('.supapress-retailer-link-asm');\n    $retailerLink.prependTo($retailerLink.parents('.supapress-field-wrapper'));\n    $retailerLink.siblings('label').prependTo($retailerLink.parents('.supapress-field-wrapper'));\n\n    // Set filters ASM select\n    $filters.html($(\"option\", $filters).sort(function (a, b) {\n        var arel = $(a).attr('rel');\n        var brel = $(b).attr('rel');\n        return arel == brel ? 0 : arel < brel ? -1 : 1;\n    }));\n\n    $filters.asmSelect({\n        addItemTarget: 'bottom',\n        animate: false,\n        hideWhenAdded: true,\n        highlight: true,\n        listType: 'ul',\n        selectClass: 'supapress-dropdown supapress-filters-asm supapress-reorder-dropdown',\n        sortable: true,\n        highlightOutsideContainer: false,\n        removeLabel: 'x',\n        svgUrl: $isbnList.attr('data-svg-url')\n    });\n\n    // Move dropdown out of container\n    var $filtersAsm = $('.supapress-filters-asm');\n    $filtersAsm.prependTo($filtersAsm.parents('.supapress-field-wrapper'));\n    $filtersAsm.siblings('label').prependTo($filtersAsm.parents('.supapress-field-wrapper'));\n\n    // Set sort by ASM select\n    $sortBy.html($(\"option\", $sortBy).sort(function (a, b) {\n        var arel = $(a).attr('rel');\n        var brel = $(b).attr('rel');\n        return arel == brel ? 0 : arel < brel ? -1 : 1;\n    }));\n\n    $sortBy.asmSelect({\n        addItemTarget: 'bottom',\n        animate: false,\n        hideWhenAdded: true,\n        highlight: true,\n        listType: 'ul',\n        selectClass: 'supapress-dropdown supapress-sort-by-asm supapress-reorder-dropdown',\n        sortable: true,\n        highlightOutsideContainer: false,\n        removeLabel: 'x',\n        svgUrl: $isbnList.attr('data-svg-url')\n    });\n\n    // Move dropdown out of container\n    var $sortByAsm = $('.supapress-sort-by-asm');\n    $sortByAsm.prependTo($sortByAsm.parents('.supapress-field-wrapper'));\n    $sortByAsm.siblings('label').prependTo($sortByAsm.parents('.supapress-field-wrapper'));\n\n    $clearCacheButton.on('click', function () {\n        if($clearCacheButton.hasClass('disabled')) {\n            return;\n        }\n        var resetButton = function() {\n            $clearCacheButton.removeClass('disabled');\n            $clearCacheButton.css('opacity', 1).text('Clear Cache');\n        };\n        $clearCacheButton.addClass('disabled').css('opacity', 0.2).text('Clearing...');\n\n        $.ajax({\n            url: 'admin-ajax.php?action=supapress_cache_clear',\n            type: 'GET',\n            dataType: 'json',\n            success: function (data) {\n                if (data.filesRemoved === 0) {\n                    $(this).updateMessage('There were no cached files to remove.', 'warning');\n                } else {\n                    var tense = data.filesRemoved === 1 ? ' has' : 's have';\n                    $(this).updateMessage(data.filesRemoved + ' cached file' + tense + ' been removed.', 'success');\n                }\n                resetButton();\n            },\n            error: function(data) {\n                if(console && 'error' in console) {\n                    console.error(data);\n                }\n                resetButton();\n            }\n        });\n    });\n\n\n    // Add predictive\n    $isbnLookup.autocomplete({\n        source: function (request, response) {\n            $.ajax({\n                url: isbnLookupAjaxUrl + '?action=supapress_predictive',\n                type: 'POST',\n                data: {\n                    term: $isbnLookup.val()\n                },\n                success: function (data) {\n                    if (data.predictive !== null && data.predictive instanceof Array) {\n                        response($.map(data.predictive, function (item) {\n                            if (typeof item.id !== 'undefined') {\n                                return {\n                                    label: item.name + ' (' + item.id + ')',\n                                    value: item.id + '|||' + item.name\n                                };\n                            }\n                        }));\n                    }\n\n                    $isbnLookup.removeClass('ui-autocomplete-loading');\n                }\n            });\n        },\n        minLength: 2,\n        open: function () {\n            $(this).data(\"uiAutocomplete\").menu.element.addClass(\"supapress-autocomplete\");\n        },\n        autoFocus: true,\n        focus: function (event) {\n            event.preventDefault();\n        },\n        select: function (event, ui) {\n            $isbnLookup.val(ui.item.value);\n\n            if (typeof event.keyCode === 'undefined' || event.keyCode !== 13) {\n                var e = jQuery.Event('keydown');\n                e.which = e.keyCode = 13;\n                $isbnLookup.trigger(e);\n            }\n\n            event.preventDefault();\n        }\n    });\n\n    $isbnLookup.on('keydown', function (e) {\n        if (e.keyCode === 13) {\n            var details = $isbnLookup.val().split('|||'),\n                $option;\n\n            if (details.length > 1) {\n                var isbn = details[0],\n                    title = details[1];\n\n                if (/^9\\d{12}$/.test(isbn) && $isbnList.find('option[data-isbn=\"' + isbn + '\"]:selected').length === 0) {\n                    $option = $(\"<option>\").text(title + ' (' + isbn + ')').val($isbnLookup.val()).attr({\n                        \"selected\": true,\n                        \"data-isbn\": isbn\n                    });\n                    $isbnList.append($option).change();\n                }\n\n                $isbnLookup.val('').removeClass('ui-autocomplete-loading');\n            } else if (/^9\\d{12}$/.test($isbnLookup.val()) && $isbnList.find('option[data-isbn=\"' + $isbnLookup.val() + '\"]:selected').length === 0) {\n                $.ajax({\n                    url: isbnLookupAjaxUrl + '?action=supapress_isbn_lookup',\n                    type: 'POST',\n                    data: {\n                        isbn: $isbnLookup.val()\n                    },\n                    success: function (data) {\n                        var title,\n                            $option = $(\"<option>\");\n\n                        if (typeof data === 'string') {\n                            title = 'ISBN not found';\n                            $option.addClass('book-not-found');\n                        } else {\n                            title = data.search[0].title;\n                        }\n\n                        $option.text(title + ' (' + $isbnLookup.val() + ')').val($isbnLookup.val() + '|||' + title).attr({\n                            \"selected\": true,\n                            \"data-isbn\": $isbnLookup.val()\n                        });\n\n                        $isbnList.append($option).change();\n                        $isbnLookup.val('').removeClass('ui-autocomplete-loading');\n                    }\n                });\n            } else {\n                $isbnLookup.val('').removeClass('ui-autocomplete-loading');\n            }\n\n            e.preventDefault();\n            return false;\n        }\n    });\n\n    $.each($isbnContainer.find('.book-not-found'), function (index, value) {\n        var $option = $(value),\n            isbn = $option.attr('data-isbn');\n\n        $.ajax({\n            url: isbnLookupAjaxUrl + '?action=supapress_isbn_lookup',\n            type: 'POST',\n            data: {\n                isbn: isbn\n            },\n            success: function (data) {\n                if (typeof data !== 'string') {\n                    var title = data.search[0].title,\n                        $newOption = $(\"<option>\");\n\n                    $newOption.text(title + ' (' + isbn + ')').val(isbn + '|||' + title).attr({\n                        \"selected\": true,\n                        \"data-isbn\": isbn\n                    });\n\n                    $option.remove();\n                    $isbnList.append($newOption).change();\n                }\n            }\n        });\n    });\n\n    if ($lookupCollection.length > 0) {\n        $.ajax({\n            url: isbnLookupAjaxUrl + '?action=supapress_collections',\n            type: 'POST',\n            data: {},\n            success: function (data) {\n                if (typeof data.filters.collection.values !== 'undefined' && data.filters.collection.values !== null) {\n                    var $newOption;\n\n                    $.each(data.filters.collection.values, function (index, value) {\n                        $newOption = $(\"<option>\");\n\n                        $newOption.text(value.name).val(value.seo_name).attr({\n                            \"data-seo\": value.seo_name\n                        });\n\n                        $lookupCollection.append($newOption);\n\n                        if ($lookupCollection.attr('data-value') === value.seo_name) {\n                            $lookupCollection.val(value.seo_name);\n                        }\n                    });\n                }\n\n                if (typeof data.catalogId !== 'undefined' && data.catalogId !== null) {\n                    $lookupCollection.attr('data-catalog-id', data.catalogId);\n\n                    // On change update link to collection\n                    $lookupCollection.on('change', function () {\n                        $editCollectionButton.attr('href', 'https://folio.supadu.com/catalog/' + $lookupCollection.attr('data-catalog-id') + '/collection/' + $lookupCollection.find(\":selected\").attr('data-seo') + '/book');\n                    });\n\n                    // Trigger change to set url on page load\n                    $lookupCollection.trigger('change');\n                }\n            }\n        });\n    }\n\n    $('.upload_image_button').click(function () {\n        var formfieldId = $('input[data-button=\"' + $(this).attr('id') + '\"]').attr('id'),\n            originalFunction = window.send_to_editor;\n\n        tb_show('', 'media-upload.php?type=image&TB_iframe=true');\n\n        window.send_to_editor = function (html) {\n            var imgurl = $('img', html).attr('src');\n            $('#' + formfieldId).val(imgurl).trigger('change');\n            tb_remove();\n            window.send_to_editor = originalFunction;\n        };\n\n        return false;\n    });\n\n    window.send_to_editor = function (html) {\n        var imgurl = $('img', html).attr('src');\n        $('#upload_image').val(imgurl);\n        tb_remove();\n    };\n\n    $arrowUpload.on('change paste keyup', function () {\n        var $this = $(this),\n            $preview = $this.siblings('.image-preview'),\n            src = $.trim($this.val()) === '' ? $preview.attr('data-default-src') : $this.val();\n\n        $preview.attr('src', src);\n    });\n\n    // Trigger on page load to set preview\n    $arrowUpload.trigger('change');\n\n    // Show image upload fields when arrows clicked\n    $arrowPreview.on('click', function () {\n        $(this).siblings('.arrow-upload, .placeholder-upload, .upload-button').css('visibility', 'visible');\n    });\n\n    // Placeholder plugin for IE9 support\n    $('input').placeholder();\n\n    // Force numbers only on inputs\n    $('input.numbers-only').on('keyup', function () {\n        var value = parseInt(this.value.replace(/[^0-9]/g, ''));\n        this.value = isNaN(value) ? '' : value;\n    });\n\n    // Set select to data-value attribute on page load\n    $('select[data-value]').each(function () {\n        var $this = $(this),\n            value = $this.find('option[value=\"' + $this.attr('data-value') + '\"]').length === 0 ? '-1' : $this.attr('data-value');\n\n        $this.val(value);\n    });\n\n    // Show/hide domain slug on Links settings\n    $('.widget_link_page').on('change', function () {\n        var $this = $(this),\n            $parents = $this.parents('.book-url'),\n            $slug = $parents.find('.supapress-domain-slug');\n\n        if ($this.val() < 0) {\n            $slug.addClass('hide');\n        } else {\n            $slug.removeClass('hide');\n        }\n\n        var $urlPattern = $parents.find('.widget_link_pattern');\n        $urlPattern.trigger('change');\n    });\n\n    // Set tooltips\n    $('.supapress-tooltip-wrapper').tooltip({\n        tooltipClass: \"supapress-ui-tooltip\",\n        content: function (callback) {\n            callback($(this).prop('title').replace('<br />', '<br />'));\n        },\n        position: {\n            my: \"center bottom-5\",\n            at: \"center top\",\n            collision: 'none',\n            using: function (position, feedback) {\n                $(this).css(position);\n                $(\"<div>\")\n                    .addClass(\"supapress-tooltip-arrow\")\n                    .addClass(feedback.vertical)\n                    .addClass(feedback.horizontal)\n                    .appendTo(this);\n            }\n        }\n    });\n\n    // When the select2 dropdown is opening (before being displayed) reorder the values. If it is the first value\n    // assume it is the \"Please {do something}\" text and set to blank so it remains as the first element in the <li>\n    $.fn.reorderSelect2Dropdown = function () {\n        var $this = $(this);\n\n        // Only relevant to asmSelect elements which have a new class set\n        if ($this.hasClass('supapress-reorder-dropdown')) {\n            $this.html($(\"option\", $(this)).sort(function (a, b) {\n                var at = $(a).is(':first-child') ? '' : $(a).text(),\n                    bt = $(b).is(':first-child') ? '' : $(b).text();\n                return (at > bt) ? 1 : ( (at < bt) ? -1 : 0 );\n            }));\n\n            // Set first child back to 'selected' state so can't be selected as creates an\n            // empty select option in sortable elements and unselectable last element\n            $this.find(':first-child').attr('selected', true);\n        }\n    };\n\n    // search filter ASM selects\n    $searchFilterLists.each(function () {\n        $(this).asmSelect({\n            addItemTarget: 'bottom',\n            animate: false,\n            hideWhenAdded: true,\n            highlight: true,\n            listType: 'ul',\n            selectClass: 'supapress-dropdown supapress-search-restriction-asm supapress-reorder-dropdown',\n            sortable: true,\n            highlightOutsideContainer: false,\n            removeLabel: 'x',\n            svgUrl: $(this).attr('data-svg-url')\n        });\n    });\n\n    // Move dropdown out of container\n    $('.supapress-search-restriction-asm').each(function () {\n        var $this = $(this);\n        $this.prependTo($this.parents('.supapress-field-wrapper'));\n        $this.siblings('label').prependTo($this.parents('.supapress-field-wrapper'));\n    });\n\n    // Set selects to be styled\n    // $('.supapress-dropdown').select2({\n    //     minimumResultsForSearch: 10\n    // }).on('select2:opening', $(this).reorderSelect2Dropdown);\n\n    $('#bulk-action-selector-top, #bulk-action-selector-bottom').select2({\n        minimumResultsForSearch: 10,\n        dropdownCssClass: 'list-page-select2'\n    });\n\n    $('#widget-type-selector-top, #widget-type-selector-bottom').select2({\n        minimumResultsForSearch: 10,\n        dropdownCssClass: 'list-page-select2'\n    });\n\n    $.fn.updateMessage = function (message, level) {\n        // Remove classes which may be attached to warning - don't want to blanket remove all, i.e. display inline\n        $message.removeClass('success warning updated created deleted error hide');\n        $message.html('<p>' + message + '</p>').addClass(level);\n    };\n\n    // do checks for elements which should be filled in\n    $supapressAddEditForm.on('submit', function () {\n        // look for the per page default setting being filled in\n        if ($showPerPage.is(':checked') && $perPageDefault.val() === '') {\n            $(this).updateMessage('Please choose a default value for \\'search per page\\'', 'warning');\n            $(window).scrollTop(0);\n            return false;\n        }\n        return true;\n    });\n\n    // Enable SVGs for IE\n    svg4everybody();\n})(jQuery);\n(function ($) {\n    window.supapress = window.supapress || {};\n\n    supapress.$wrap = null;\n    supapress.$message = null;\n    supapress.$form = null;\n    supapress.$urlPattern = null;\n    supapress.bookUrlOptions = [\n        { value : \"isbn13\", label : \"ISBN-13\", example : \"9998887770001\" },\n        { value : \"isbn10\", label : \"ISBN-10\", example : \"8765432101\" },\n        { value : \"title\", label : \"Title\", example : \"my-book\" },\n        { value : \"subtitle\", label : \"Subtitle\", example : \"my-book-subtitle\" },\n        { value : \"format\", label : \"Format\", example : \"my-format\" },\n        { value : \"text-title\", label : \"Full Book Title\", example : \"My Book\" },\n        { value : \"author\", label : \"Author\", example : \"my-author\" },\n        { value : \"imprint\", label : \"Imprint\", example : \"my-imprint\" },\n        { value : \"publisher\", label : \"Publisher\", example : \"my-publisher\" },\n        { value : \"description\", label : \"Description\", example : \"my description\" }\n    ];\n    supapress.trackingPatternOptions = [\n        { value : \"isbn13\", label : \"ISBN-13\", example : \"9998887770001\" },\n        { value : \"isbn10\", label : \"ISBN-10\", example : \"8765432101\" },\n        { value : \"title\", label : \"Title\", example : \"my-book\" },\n        { value : \"subtitle\", label : \"Subtitle\", example : \"my-book-subtitle\" },\n        { value : \"format\", label : \"Format\", example : \"my-format\" },\n        { value : \"text-title\", label : \"Full Book Title\", example : \"My Book\" },\n        { value : \"author\", label : \"Author\", example : \"my-author\" },\n        { value : \"imprint\", label : \"Imprint\", example : \"my-imprint\" },\n        { value : \"publisher\", label : \"Publisher\", example : \"my-publisher\" },\n        { value : \"description\", label : \"Description\", example : \"my description\" },\n        { value : \"price_usd\", label : \"Price (full) - USD\", example : \"0.00\" },\n        { value : \"discount_usd\", label : \"Price (discount) - USD\", example : \"0.00\" },\n        { value : \"price_gbp\", label : \"Price (full) - GBP\", example : \"0.00\" },\n        { value : \"discount_gbp\", label : \"Price (discount) - GBP\", example : \"0.00\" },\n        { value : \"price_cad\", label : \"Price (full) - CAD\", example : \"0.00\" },\n        { value : \"discount_cad\", label : \"Price (discount) - CAD\", example : \"0.00\" }\n    ];\n    supapress.resultCountTextOptions = [\n        { value : \"total\", label : \"Total Results\", example : \"100\" },\n        { value : \"pagestart\", label : \"Page Start\", example : \"1\" },\n        { value : \"pageend\", label : \"Page End\", example : \"10\" }\n    ];\n    supapress.searchTermTextOptions = [\n        { value : \"term\", label : \"Search Term\", example : \"Lord of the Rings\" }\n    ];\n\n    $.fn.insertAtCaret = function (newText) {\n        var $this = $(this),\n            start = $this.prop(\"selectionStart\"),\n            end = $this.prop(\"selectionEnd\"),\n            text = $this.val(),\n            before = text.substring(0, start),\n            after  = text.substring(end, text.length);\n\n        $this.val(before + newText + after);\n        $this[0].selectionStart = $this[0].selectionEnd = start + newText.length;\n        $this.focus();\n    };\n\n    $.fn.addAutoComplete = function (options) {\n        var $this = $(this);\n\n        $this.autocomplete({\n            source: options,\n            minLength: 0,\n            open: function() {\n                $(this).data(\"uiAutocomplete\").menu.element.addClass(\"supapress-autocomplete\");\n            },\n            focus: function(event) {\n                event.preventDefault();\n            },\n            select: function(event, ui) {\n                $this.insertAtCaret(ui.item.value + '%');\n                return false;\n            },\n            _renderItem: function(ul, item) {\n                return $(\"<li>\").append(item.label).appendTo(ul);\n            }\n        });\n\n        $this.on('keydown', function(e) {\n            if(e.which === 13) {\n                return false;\n            }\n        });\n\n        $this.on('keyup', function(e) {\n            if(e.shiftKey && e.which === 53) {\n                $this.autocomplete( \"search\", \"\" );\n            }\n        });\n\n        $this.on('change paste keyup', function() {\n            var value = $this.val(),\n                $bookUrl = $this.parents('.book-url'),\n                $retailerLink = $this.parents('.retailer-link'),\n                relativeLink,\n                regex;\n\n            if( (!$bookUrl.length && !$retailerLink.length) || $this.hasClass('no-preview') ) {\n                return;\n            }\n\n            relativeLink = $bookUrl.find('.widget_link_page').val() > 0;\n\n            $.each(options, function(index, obj) {\n                regex = new RegExp(\"%\" + obj.value + \"%\",\"g\");\n                value =  value.replace(regex, obj.example );\n            });\n\n            $this.parents('.book-url').find('.widget_link_preview').html( '<span class=\"placeholder\">' + (relativeLink ? $(\".supapress-domain-slug\").html()  : '') + value +'</span>' );\n            $this.parents('.retailer-link').find('.widget_link_preview').html( '<span class=\"placeholder\">' + value + '</span>' );\n        });\n\n        $this.on('blur', function() {\n            var $this = $(this);\n\n            if($.trim($this.val()) === '' && $this.data('default')) {\n                $this.val($this.data('default'));\n            }\n\n            // clean up book urls, remove any extra slashes except one\n            if ( /\\/$/.test($this.val()) && $this.data('trim-trailing-slash')) {\n                $this.val( $this.val().replace( /\\/{2,}$/, '/') );\n            }\n\n            $this.trigger('change');\n        });\n\n        $this.trigger('blur');\n    };\n\n    $.fn.supapressAdminInit = function () {\n        supapress.$wrap = this;\n        supapress.$message = supapress.$wrap.find('#message');\n        supapress.$form = supapress.$wrap.find('#supapress-settings-form');\n        supapress.$urlPattern = supapress.$wrap.find('.widget_link_pattern');\n        supapress.$resultCountText = $('#supapress-result-count-text');\n        supapress.$searchTermText = $('#supapress-search-term-text');\n        supapress.$seoCanonical = $('#supapress-product-details-seo-canonical');\n        supapress.$retailerUpload = $('.retailer-image-upload');\n        supapress.$retailers = $('.retailer-links .retailers');\n        supapress.$retailerLinkFormats = $('.retailer-links .retailer_link_formats');\n        supapress.$addNewRetailer = $('.retailer-links .add-new-wrapper .add-new-button');\n        supapress.$addNewRetailerLoader = $('.retailer-links .add-new-wrapper .loading-icon');\n\n        var supapressAddAutoComplete = function() {\n            var $this = $(this);\n            var options = $this.hasClass(\"tracking-pattern\") ? \"trackingPatternOptions\" : \"bookUrlOptions\";\n            $this.addAutoComplete(supapress[options]);\n        };\n\n        // Attach autocomplete to each url pattern\n        $.each(supapress.$urlPattern, supapressAddAutoComplete);\n\n        // add autocomplete for the search term message and result count options\n        supapress.$resultCountText.addAutoComplete(supapress.resultCountTextOptions);\n        supapress.$searchTermText.addAutoComplete(supapress.searchTermTextOptions);\n\n        // Set retailer link image preview\n        supapress.$retailerUpload.on('change paste keyup', function() {\n            var $this = $(this),\n                $preview = $this.siblings('.image-preview'),\n                src = $.trim($this.val()) === '' ? $preview.attr('data-default-src') : $this.val();\n\n            $preview.attr('src', src);\n        });\n\n        // On click get new template for retailer link\n        supapress.$addNewRetailer.on('click', function() {\n            supapress.$addNewRetailer.addClass('hide');\n            supapress.$addNewRetailerLoader.removeClass('hide');\n\n            $.ajax({\n                url: 'admin-ajax.php?action=supapress_new_retailer_link',\n                type: 'POST',\n                data: {\n                    count: supapress.$retailerLinkFormats.length\n                },\n                success: function (data) {\n                    supapress.$retailers.append(data);\n                    supapress.$addNewRetailer.removeClass('hide');\n                    supapress.$addNewRetailerLoader.addClass('hide');\n\n                    var $wrap = supapress.$retailers.find('.retailer-link:last-child');\n                    var $element = $wrap.find('.supapress-accordion-header');\n                    var $urlPattern = $wrap.find('.widget_link_pattern');\n                    var $dropdowns = $wrap.find('.supapress-dropdown');\n\n                    $.each($urlPattern, supapressAddAutoComplete);\n\n                    $element.on('click', function() {\n                        var $this = $(this),\n                            $elementParent = $this.parents('.supapress-accordion-wrapper'),\n                            $elementArrow = $elementParent.find('.svg-right-arrow'),\n                            $elementConfig = $elementParent.find('.supapress-accordion-content');\n\n                        if($elementConfig.css('display') === 'none') {\n                            $elementConfig.slideDown();\n                            $elementArrow.addClass('open');\n                            $this.addClass('open');\n                        } else {\n                            $elementConfig.slideUp();\n                            $elementArrow.removeClass('open');\n                            $this.removeClass('open');\n                        }\n                    });\n\n                    $.each($dropdowns, function() {\n                        $select2 = $(this).select2({width: '100%'});\n\n                        if($select2.data('select2').$dropdown) {\n                            $select2.data('select2').$dropdown.addClass(\"supapress-select2-drop\");\n                        } else if($select2.data('select2').dropdown) {\n                            $select2.data('select2').dropdown.addClass(\"supapress-select2-drop\");\n                        }\n                    });\n\n                    $wrap.find('.upload_image_button').on('click', function () {\n                        var $formfield = $wrap.find('input[data-button=\"' + $(this).attr('id') + '\"]'),\n                            originalFunction = window.send_to_editor;\n\n                        tb_show('', 'media-upload.php?type=image&TB_iframe=true');\n\n                        $formfield.on('change paste keyup', function () {\n                            var $this = $(this),\n                                $preview = $this.siblings('.image-preview'),\n                                src = $.trim($this.val()) === '' ? $preview.attr('data-default-src') : $this.val();\n\n                            $preview.attr('src', src);\n                        });\n\n                        window.send_to_editor = function (html) {\n                            var imgurl = $('img', html).attr('src');\n                            $formfield.val(imgurl).trigger('change');\n                            tb_remove();\n                            window.send_to_editor = originalFunction;\n                        };\n\n                        return false;\n                    });\n\n                }\n            });\n        });\n\n        // Catch form submit for validation checks\n        supapress.$form.on('submit', function() {\n            var error = false;\n\n            // validation for book urls\n            supapress.$wrap.find('.book-url .widget_link_pattern').each(function() {\n                var $this = $(this),\n                    pattern = $this.val(),\n                    page = $this.parents('.supapress-accordion-content-inner').find('.widget_link_page'),\n                    domainProtocolRegExp = new RegExp(\"^http(s*):\\/\\/\"),\n                    errorMessage = '',\n                    pageVal = parseInt(page.val());\n\n                if (pageVal > 0) {\n                    if (/%isbn13%/.test(pattern) === false) {\n                        errorMessage = 'Book page URLs must contain an ISBN-13 so we can find your book. Please make sure \"%isbn13%\" is found in your url patterns.';\n                    } else if (domainProtocolRegExp.test(pattern) !== false) {\n                        errorMessage = 'Book page URLs should not contain the full URL.';\n                    } else if (/^\\//.test(pattern) === false) {\n                        errorMessage = 'Book page URLs must start with a slash';\n                    }\n                } else if (pageVal === -2 && domainProtocolRegExp.test(pattern) === false) {\n                    errorMessage = 'External links should contain the full URL.';\n                }\n\n                if (errorMessage) {\n                    supapress.$message.addClass('warning').removeClass('hide');\n                    supapress.$message.find('p').text(errorMessage);\n                    supapress.$wrap.find('.nav-tab[data-tab=\"links\"]').trigger('click');\n                    error = true;\n                    return false;\n                }\n            });\n\n            // validation for retailer links\n            supapress.$wrap.find('.retailers .retailer-link ').each(function() {\n                var $this = $(this),\n                    $retailerName =  $this.find('.widget_retailer_name').val(),\n                    $retailerLinkPattern = $this.find('.widget_link_pattern').val(),\n                    errorMessage = '';\n\n                if ($retailerName.trim() === \"\") {\n                    errorMessage = 'All retailer links require a name.';\n                } else if ($retailerName.trim() === \"\") {\n                    errorMessage = 'All retailer links require a link.';\n                }\n\n                if (errorMessage) {\n                    supapress.$message.addClass('warning').removeClass('hide');\n                    supapress.$message.find('p').text(errorMessage);\n                    supapress.$wrap.find('.nav-tab[data-tab=\"retailer-links\"]').trigger('click');\n                    error = true;\n                    return false;\n                }\n\n            });\n\n            // validation for canonical\n            var pattern = supapress.$seoCanonical.val(),\n                domainProtocolRegExp = new RegExp(\"^http(s*):\\/\\/\"),\n                errorMessage = '';\n\n            if (/%isbn13%/.test(pattern) === false) {\n                errorMessage = 'Canonical URL must contain an ISBN-13 so we can find your book. Please make sure \"%isbn13%\" is found in your url patterns.';\n            } else if (domainProtocolRegExp.test(pattern) !== false) {\n                errorMessage = 'Canonical URL should not contain the full URL.';\n            } else if (/^\\//.test(pattern) === false) {\n                errorMessage = 'Canonical URL must start with a slash';\n            }\n\n            if (errorMessage) {\n                supapress.$message.addClass('warning').removeClass('hide');\n                supapress.$message.find('p').text(errorMessage);\n                supapress.$wrap.find('.nav-tab[data-tab=\"seo\"]').trigger('click');\n                error = true;\n            }\n\n            if(error === true) {\n                window.scrollTo(0, 0);\n                return false;\n            }\n        });\n\n    };\n\n    $(function() {\n        $('div.supapress-wrap.settings').supapressAdminInit();\n    });\n})(jQuery);\n"]}