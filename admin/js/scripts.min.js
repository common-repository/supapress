!function(e){var a=jQuery.noConflict(),t=a(".supapress-wrap"),s=t.find("#supapress-add-edit-form"),n=t.find("#step1"),r=t.find("#step2"),i=t.find("#message"),l=t.find(".supapress-accordion-header"),o=t.find(".elements.nav-tab-content .selector"),p=t.find("#step1_next_btn"),d=t.find(".widget-title-wrapper"),u=t.find(".widget-type-wrapper"),c=d.find("#widget-title"),h=t.find('input[name="widget_layout"]'),v=t.find(".sub-content-toggle"),f=t.find(".nav-tab"),m=t.find(".nav-tab-content"),g=t.find(".layout-content"),b=t.find("#lookup_source"),w=t.find("#isbn_lookup_bulk"),k=t.find(".lookup-source-input"),C=t.find(".save-button-wrapper"),_=!0,y=!0,x="",T=function(){u.prependTo(r),d.prependTo(r).find("p").hide(),u.find("input").on("change",function(){var t=e(this),s=u.find('label[for="'+t.attr("id")+'"]');s.prependTo(s.parent()),t.prependTo(t.parent()),S(u.find("input:checked").val()),$(m,a(".nav-tab-active").attr("data-tab")),$(g,a(".widget-layout-wrapper").find("input:checked").attr("data-sub-tab"))}),u.find("input").on("click",function(){u.hasClass("open")?u.removeClass("open"):u.addClass("open")}),u.find("input:checked").trigger("change"),S(u.find("input:checked").val()),$(m,a(".nav-tab-active").attr("data-tab")),$(g,a(".widget-layout-wrapper").find("input:checked").attr("data-sub-tab"))},$=function(s,n){s.each(function(){var a=e(this);a.hasClass(n)&&!a.hasClass("sub-content-wrapper")?("elements"===n?o.find(".supapress-field-wrapper").each(function(){var a=e(this);a.hasClass("all-tabs")||a.hasClass(u.find("input:checked").val())?a.show():a.hide().find("input:checked").attr("checked",!1)}):"arrangement"===n&&a.find(".widget-layout-wrapper-inner").each(function(){var a=e(this);a.hasClass(u.find("input:checked").val())?a.show():a.hide()}),a.show()):a.hide()}),e(".widget-type-specific").each(function(){var a=e(this);a.hasClass(u.find("input:checked").val())?(a.show(),a.hasClass("custom_layout_file")&&a.find("select").removeAttr("disabled")):(a.hide(),a.hasClass("custom_layout_file")&&a.find("select").attr("disabled","disabled"))}),"isbn_lookup"!==u.find("input:checked").val()&&(t.find(".carousel.layout-content").hide(),"carousel"===a(".widget-layout-wrapper").find("input:checked").val()&&t.find("#widget_layout1").trigger("click")),_=!1,y=!1,v.trigger("change"),y=!0},S=function(e){"product_details"===e?(t.find(".custom_layout_file.product_details").length?(t.find('.nav-tab[data-tab="content"]').removeClass("nav-tab-active").hide(),t.find('.nav-tab[data-tab="arrangement"]').removeClass("nav-tab-active").show(),h.filter('[value="custom"]').prop("checked",!0)):(t.find('.nav-tab[data-tab="content"], .nav-tab[data-tab="arrangement"]').removeClass("nav-tab-active").hide(),h.filter('[value="grid"]').prop("checked",!0)),t.find('.nav-tab[data-tab="elements"]').addClass("nav-tab-active").show(),t.find('.nav-tab[data-tab="restrictions"]').hide()):"search_results"===e?(t.find(".nav-tab").removeClass("nav-tab-active").show(),t.find('.nav-tab[data-tab="content"], .nav-tab[data-tab="seo"]').hide(),t.find('.nav-tab[data-tab="restrictions"]').show(),t.find('.nav-tab[data-tab="elements"]').addClass("nav-tab-active")):(t.find(".nav-tab").removeClass("nav-tab-active").show(),t.find('.nav-tab[data-tab="seo"], .nav-tab[data-tab="restrictions"]').hide(),t.find('.nav-tab[data-tab="content"]').addClass("nav-tab-active"))},P=function(e){var a,t,s=decodeURIComponent(window.location.search.substring(1)),n=s.split("&");for(t=0;t<n.length;t++)if(a=n[t].split("="),a[0]===e)return void 0===a[1]?"":a[1]};f.on("click",function(){var a=e(this);C.hasClass("hide");f.removeClass("nav-tab-active"),a.addClass("nav-tab-active"),$(m,a.attr("data-tab"))}),h.on("change",function(){$(g,e(this).attr("data-sub-tab"))}),$(g,e('input[name="widget_layout"]:checked').attr("data-sub-tab")),b.on("change",function(){k.each(function(){var a=e(this);a.hasClass(b.val())?a.show():a.hide()})}),b.trigger("change"),p.on("click",function(){""===e.trim(c.val())?(i.addClass("warning").removeClass("hide"),i.find("p").text("Please enter a name for your widget")):(n.hide(),r.show(),i.addClass("hide"),T())}),v.on("change",function(){var a=e(this),t=e("div."+a.attr("data-sub-content"));a.prop("checked")&&(t.hasClass(e('input[name="widget_layout"]:checked').attr("data-sub-tab"))||t.hasClass("tab-level"))?"none"===t.css("display")&&_?t.fadeIn():t.show():"none"!==t.css("display")&&y?t.fadeOut():t.hide(),_=!0}),l.on("click",function(){var a=e(this),t=a.parents(".supapress-accordion-wrapper"),s=t.find(".svg-right-arrow"),n=t.find(".supapress-accordion-content");"none"===n.css("display")?(n.slideDown(),s.addClass("open"),a.addClass("open")):(n.slideUp(),s.removeClass("open"),a.removeClass("open"))}),s.on("submit",function(){return""===e.trim(c.val())?(i.addClass("warning").removeClass("hide"),i.find("p").text("Please enter a name for your widget"),!1):0===t.find(".elements.nav-tab-content .selector input:checked").length?(i.addClass("warning").removeClass("hide"),i.find("p").text("Please choose at least one element to display in your widget."),t.find('.nav-tab[data-tab="elements"]').trigger("click"),window.scrollTo(0,0),!1):"product_details"===u.find("input:checked").val()||e('input[name="widget_layout"]:checked').parents(".widget-layout-wrapper-inner").hasClass(u.find("input:checked").val())?"isbn_lookup"===u.find("input:checked").val()&&"bulk"===b.val()&&""!==w.val()?(i.addClass("warning").removeClass("hide"),i.find("p").text('Please use the "Add ISBN(s)" button to add your entered ISBN(s) to the list.'),t.find('.nav-tab[data-tab="content"]').trigger("click"),window.scrollTo(0,0),!1):"custom"!==e('input[name="widget_layout"]:checked').val()||e("#custom_layout_file_"+e('input[name="widget_type"]:checked').val()).val()?void 0:(i.addClass("warning").removeClass("hide"),i.find("p").text("Please select a template for your custom layout"),t.find('.nav-tab[data-tab="arrangement"]').trigger("click"),window.scrollTo(0,0),!1):(i.addClass("warning").removeClass("hide"),i.find("p").text("Please choose how to display your widget (e.g. Grid or List)"),t.find('.nav-tab[data-tab="arrangement"]').trigger("click"),window.scrollTo(0,0),!1)}),t.hasClass("edit")&&T(),x=P("type"),x&&(u.find('input[value="'+x+'"]').click(),n.hide(),r.show(),i.addClass("hide"),T())}(jQuery),function(e){var a=jQuery.noConflict(),t=a("#isbn_list"),s=a("#price"),n=a("#retailer_links"),r=a("#message"),i=a("#filters"),l=a("#sort_by"),o=a("#per_page"),p=a("#show_per_page"),d=a("#per_page_input"),u=a("#per_page_input_btn"),c=a("#per_page_default"),h=e(".supapress-isbn-lookup-asm"),v=a("#isbn_lookup"),f=a("#isbn_lookup_label"),m=a("#lookup_collection"),g=a(".edit-collection-button"),b=a(".arrow-upload, .placeholder-upload"),w=a(".show-arrows .image-preview, .lazy-load .image-preview"),k=a("#supapress-clear-cache-button"),C=a("#supapress-add-bulk-isbns-button"),_=a("#isbn_lookup_bulk"),y=v.attr("data-ajax-url"),x=a("#supapress-add-edit-form"),T=a(".supapress-search-restriction-list"),$=t.asmSelect({addItemTarget:"bottom",animate:!1,hideWhenAdded:!0,highlight:!0,listType:"ul",selectClass:"supapress-isbn-lookup-asm",sortable:!0,highlightOutsideContainer:!0,removeLabel:"x",svgUrl:t.attr("data-svg-url")});f.insertBefore(h),v.insertBefore(h),s.html(e("option",s).sort(function(a,t){var s=e(a).attr("rel"),n=e(t).attr("rel");return s==n?0:s<n?-1:1})),s.asmSelect({addItemTarget:"bottom",animate:!1,hideWhenAdded:!0,highlight:!0,listType:"ul",selectClass:"supapress-dropdown supapress-price-locale-asm supapress-reorder-dropdown",sortable:!0,highlightOutsideContainer:!1,removeLabel:"x",svgUrl:t.attr("data-svg-url")}),n.html(e("option",n).sort(function(a,t){var s=e(a).attr("rel"),n=e(t).attr("rel");return s==n?0:s<n?-1:1})),n.asmSelect({addItemTarget:"bottom",animate:!1,hideWhenAdded:!0,highlight:!0,listType:"ul",selectClass:"supapress-dropdown supapress-retailer-link-asm supapress-reorder-dropdown",sortable:!0,highlightOutsideContainer:!1,removeLabel:"x",svgUrl:t.attr("data-svg-url")}),C.on("click",function(){e.ajax({url:"admin-ajax.php?action=supapress_bulk_isbn_lookup",type:"POST",data:{ISBNs:_.val().replace(/\n/g,",").replace(/ /g,"").replace(/,+/g,",")},dataType:"json",success:function(a){for(var s in a.ISBNs){var n=a.ISBNs[s],r=n.title+" ("+s+")",i=s+"|||"+n.title,l=t.find('option[data-isbn="'+s+'"]:selected'),o=e("<option>").text(r).val(i).attr({selected:!0,"data-isbn":s});n.found===-1&&o.addClass("book-not-found"),1===l.length&&l.remove(),t.append(o)}t.change(),_.val("")}})}),u.on("click",function(){var a=e("#per_page_input").val();return a>100||a<1?alert("Number should be between 1 and 100"):e("#per_page option:selected[value='"+a+"']").length?alert(a+" has already been set"):a&&(c.append(e("<option></option>").text(a).attr("value",a)),o.append(e("<option></option>").text(a).attr("selected",!0).attr("value",a)).change()),d.val(""),!1}),d.keypress(function(e){if(13==e.which)return u.click(),!1}),o.asmSelect({addItemTarget:"bottom",animate:!1,hideWhenAdded:!0,highlight:!0,listType:"ul",selectClass:"hide",sortable:!0,highlightOutsideContainer:!1,removeLabel:"x",svgUrl:t.attr("data-svg-url")}),e("body").on("change","#per_page",function(){var a=o.children("option:selected"),t=c.children("option");if(a.length===t.length)return!1;var s=c.select2("val");a.sort(function(e,a){return e=e.value,a=a.value,e-a}),c.empty().append(e("<option>").text("No default set").val("")),a.each(function(){var a=e("<option>").text(e(this).val()).val(e(this).val());s===e(this).val()&&a.attr("selected",!0),c.append(a)}),c.select2("val")||(c.select2("val",""),s&&alert("You have removed the set default value"))}),o.html(e("option",o).sort(function(a,t){var s=e(a).attr("rel"),n=e(t).attr("rel");return s==n?0:s<n?-1:1}));var S=e(".supapress-price-locale-asm");S.prependTo(S.parents(".supapress-field-wrapper")),S.siblings("label").prependTo(S.parents(".supapress-field-wrapper"));var P=e(".supapress-retailer-link-asm");P.prependTo(P.parents(".supapress-field-wrapper")),P.siblings("label").prependTo(P.parents(".supapress-field-wrapper")),i.html(e("option",i).sort(function(a,t){var s=e(a).attr("rel"),n=e(t).attr("rel");return s==n?0:s<n?-1:1})),i.asmSelect({addItemTarget:"bottom",animate:!1,hideWhenAdded:!0,highlight:!0,listType:"ul",selectClass:"supapress-dropdown supapress-filters-asm supapress-reorder-dropdown",sortable:!0,highlightOutsideContainer:!1,removeLabel:"x",svgUrl:t.attr("data-svg-url")});var I=e(".supapress-filters-asm");I.prependTo(I.parents(".supapress-field-wrapper")),I.siblings("label").prependTo(I.parents(".supapress-field-wrapper")),l.html(e("option",l).sort(function(a,t){var s=e(a).attr("rel"),n=e(t).attr("rel");return s==n?0:s<n?-1:1})),l.asmSelect({addItemTarget:"bottom",animate:!1,hideWhenAdded:!0,highlight:!0,listType:"ul",selectClass:"supapress-dropdown supapress-sort-by-asm supapress-reorder-dropdown",sortable:!0,highlightOutsideContainer:!1,removeLabel:"x",svgUrl:t.attr("data-svg-url")});var R=e(".supapress-sort-by-asm");R.prependTo(R.parents(".supapress-field-wrapper")),R.siblings("label").prependTo(R.parents(".supapress-field-wrapper")),k.on("click",function(){if(!k.hasClass("disabled")){var a=function(){k.removeClass("disabled"),k.css("opacity",1).text("Clear Cache")};k.addClass("disabled").css("opacity",.2).text("Clearing..."),e.ajax({url:"admin-ajax.php?action=supapress_cache_clear",type:"GET",dataType:"json",success:function(t){if(0===t.filesRemoved)e(this).updateMessage("There were no cached files to remove.","warning");else{var s=1===t.filesRemoved?" has":"s have";e(this).updateMessage(t.filesRemoved+" cached file"+s+" been removed.","success")}a()},error:function(e){console&&"error"in console&&console.error(e),a()}})}}),v.autocomplete({source:function(a,t){e.ajax({url:y+"?action=supapress_predictive",type:"POST",data:{term:v.val()},success:function(a){null!==a.predictive&&a.predictive instanceof Array&&t(e.map(a.predictive,function(e){if("undefined"!=typeof e.id)return{label:e.name+" ("+e.id+")",value:e.id+"|||"+e.name}})),v.removeClass("ui-autocomplete-loading")}})},minLength:2,open:function(){e(this).data("uiAutocomplete").menu.element.addClass("supapress-autocomplete")},autoFocus:!0,focus:function(e){e.preventDefault()},select:function(e,a){if(v.val(a.item.value),"undefined"==typeof e.keyCode||13!==e.keyCode){var t=jQuery.Event("keydown");t.which=t.keyCode=13,v.trigger(t)}e.preventDefault()}}),v.on("keydown",function(a){if(13===a.keyCode){var s,n=v.val().split("|||");if(n.length>1){var r=n[0],i=n[1];/^9\d{12}$/.test(r)&&0===t.find('option[data-isbn="'+r+'"]:selected').length&&(s=e("<option>").text(i+" ("+r+")").val(v.val()).attr({selected:!0,"data-isbn":r}),t.append(s).change()),v.val("").removeClass("ui-autocomplete-loading")}else/^9\d{12}$/.test(v.val())&&0===t.find('option[data-isbn="'+v.val()+'"]:selected').length?e.ajax({url:y+"?action=supapress_isbn_lookup",type:"POST",data:{isbn:v.val()},success:function(a){var s,n=e("<option>");"string"==typeof a?(s="ISBN not found",n.addClass("book-not-found")):s=a.search[0].title,n.text(s+" ("+v.val()+")").val(v.val()+"|||"+s).attr({selected:!0,"data-isbn":v.val()}),t.append(n).change(),v.val("").removeClass("ui-autocomplete-loading")}}):v.val("").removeClass("ui-autocomplete-loading");return a.preventDefault(),!1}}),e.each($.find(".book-not-found"),function(a,s){var n=e(s),r=n.attr("data-isbn");e.ajax({url:y+"?action=supapress_isbn_lookup",type:"POST",data:{isbn:r},success:function(a){if("string"!=typeof a){var s=a.search[0].title,i=e("<option>");i.text(s+" ("+r+")").val(r+"|||"+s).attr({selected:!0,"data-isbn":r}),n.remove(),t.append(i).change()}}})}),m.length>0&&e.ajax({url:y+"?action=supapress_collections",type:"POST",data:{},success:function(a){if("undefined"!=typeof a.filters.collection.values&&null!==a.filters.collection.values){var t;e.each(a.filters.collection.values,function(a,s){t=e("<option>"),t.text(s.name).val(s.seo_name).attr({"data-seo":s.seo_name}),m.append(t),m.attr("data-value")===s.seo_name&&m.val(s.seo_name)})}"undefined"!=typeof a.catalogId&&null!==a.catalogId&&(m.attr("data-catalog-id",a.catalogId),m.on("change",function(){g.attr("href","https://folio.supadu.com/catalog/"+m.attr("data-catalog-id")+"/collection/"+m.find(":selected").attr("data-seo")+"/book")}),m.trigger("change"))}}),e(".upload_image_button").click(function(){var a=e('input[data-button="'+e(this).attr("id")+'"]').attr("id"),t=window.send_to_editor;return tb_show("","media-upload.php?type=image&TB_iframe=true"),window.send_to_editor=function(s){var n=e("img",s).attr("src");e("#"+a).val(n).trigger("change"),tb_remove(),window.send_to_editor=t},!1}),window.send_to_editor=function(a){var t=e("img",a).attr("src");e("#upload_image").val(t),tb_remove()},b.on("change paste keyup",function(){var a=e(this),t=a.siblings(".image-preview"),s=""===e.trim(a.val())?t.attr("data-default-src"):a.val();t.attr("src",s)}),b.trigger("change"),w.on("click",function(){e(this).siblings(".arrow-upload, .placeholder-upload, .upload-button").css("visibility","visible")}),e("input").placeholder(),e("input.numbers-only").on("keyup",function(){var e=parseInt(this.value.replace(/[^0-9]/g,""));this.value=isNaN(e)?"":e}),e("select[data-value]").each(function(){var a=e(this),t=0===a.find('option[value="'+a.attr("data-value")+'"]').length?"-1":a.attr("data-value");a.val(t)}),e(".widget_link_page").on("change",function(){var a=e(this),t=a.parents(".book-url"),s=t.find(".supapress-domain-slug");a.val()<0?s.addClass("hide"):s.removeClass("hide");var n=t.find(".widget_link_pattern");n.trigger("change")}),e(".supapress-tooltip-wrapper").tooltip({tooltipClass:"supapress-ui-tooltip",content:function(a){a(e(this).prop("title").replace("<br />","<br />"))},position:{my:"center bottom-5",at:"center top",collision:"none",using:function(a,t){e(this).css(a),e("<div>").addClass("supapress-tooltip-arrow").addClass(t.vertical).addClass(t.horizontal).appendTo(this)}}}),e.fn.reorderSelect2Dropdown=function(){var a=e(this);a.hasClass("supapress-reorder-dropdown")&&(a.html(e("option",e(this)).sort(function(a,t){var s=e(a).is(":first-child")?"":e(a).text(),n=e(t).is(":first-child")?"":e(t).text();return s>n?1:s<n?-1:0})),a.find(":first-child").attr("selected",!0))},T.each(function(){e(this).asmSelect({addItemTarget:"bottom",animate:!1,hideWhenAdded:!0,highlight:!0,listType:"ul",selectClass:"supapress-dropdown supapress-search-restriction-asm supapress-reorder-dropdown",sortable:!0,highlightOutsideContainer:!1,removeLabel:"x",svgUrl:e(this).attr("data-svg-url")})}),e(".supapress-search-restriction-asm").each(function(){var a=e(this);a.prependTo(a.parents(".supapress-field-wrapper")),a.siblings("label").prependTo(a.parents(".supapress-field-wrapper"))}),e("#bulk-action-selector-top, #bulk-action-selector-bottom").select2({minimumResultsForSearch:10,dropdownCssClass:"list-page-select2"}),e("#widget-type-selector-top, #widget-type-selector-bottom").select2({minimumResultsForSearch:10,dropdownCssClass:"list-page-select2"}),e.fn.updateMessage=function(e,a){r.removeClass("success warning updated created deleted error hide"),r.html("<p>"+e+"</p>").addClass(a)},x.on("submit",function(){return!p.is(":checked")||""!==c.val()||(e(this).updateMessage("Please choose a default value for 'search per page'","warning"),e(window).scrollTop(0),!1)}),svg4everybody()}(jQuery),function(e){window.supapress=window.supapress||{},supapress.$wrap=null,supapress.$message=null,supapress.$form=null,supapress.$urlPattern=null,supapress.bookUrlOptions=[{value:"isbn13",label:"ISBN-13",example:"9998887770001"},{value:"isbn10",label:"ISBN-10",example:"8765432101"},{value:"title",label:"Title",example:"my-book"},{value:"subtitle",label:"Subtitle",example:"my-book-subtitle"},{value:"format",label:"Format",example:"my-format"},{value:"text-title",label:"Full Book Title",example:"My Book"},{value:"author",label:"Author",example:"my-author"},{value:"imprint",label:"Imprint",example:"my-imprint"},{value:"publisher",label:"Publisher",example:"my-publisher"},{value:"description",label:"Description",example:"my description"}],supapress.trackingPatternOptions=[{value:"isbn13",label:"ISBN-13",example:"9998887770001"},{value:"isbn10",label:"ISBN-10",example:"8765432101"},{value:"title",label:"Title",example:"my-book"},{value:"subtitle",label:"Subtitle",example:"my-book-subtitle"},{value:"format",label:"Format",example:"my-format"},{value:"text-title",label:"Full Book Title",example:"My Book"},{value:"author",label:"Author",example:"my-author"},{value:"imprint",label:"Imprint",example:"my-imprint"},{value:"publisher",label:"Publisher",example:"my-publisher"},{value:"description",label:"Description",example:"my description"},{value:"price_usd",label:"Price (full) - USD",example:"0.00"},{value:"discount_usd",label:"Price (discount) - USD",example:"0.00"},{value:"price_gbp",label:"Price (full) - GBP",example:"0.00"},{value:"discount_gbp",label:"Price (discount) - GBP",example:"0.00"},{value:"price_cad",label:"Price (full) - CAD",example:"0.00"},{value:"discount_cad",label:"Price (discount) - CAD",example:"0.00"}],supapress.resultCountTextOptions=[{value:"total",label:"Total Results",example:"100"},{value:"pagestart",label:"Page Start",example:"1"},{value:"pageend",label:"Page End",example:"10"}],supapress.searchTermTextOptions=[{value:"term",label:"Search Term",example:"Lord of the Rings"}],e.fn.insertAtCaret=function(a){var t=e(this),s=t.prop("selectionStart"),n=t.prop("selectionEnd"),r=t.val(),i=r.substring(0,s),l=r.substring(n,r.length);t.val(i+a+l),t[0].selectionStart=t[0].selectionEnd=s+a.length,t.focus()},e.fn.addAutoComplete=function(a){var t=e(this);t.autocomplete({source:a,minLength:0,open:function(){e(this).data("uiAutocomplete").menu.element.addClass("supapress-autocomplete")},focus:function(e){e.preventDefault()},select:function(e,a){return t.insertAtCaret(a.item.value+"%"),!1},_renderItem:function(a,t){return e("<li>").append(t.label).appendTo(a)}}),t.on("keydown",function(e){if(13===e.which)return!1}),t.on("keyup",function(e){e.shiftKey&&53===e.which&&t.autocomplete("search","")}),t.on("change paste keyup",function(){var s,n,r=t.val(),i=t.parents(".book-url"),l=t.parents(".retailer-link");!i.length&&!l.length||t.hasClass("no-preview")||(s=i.find(".widget_link_page").val()>0,e.each(a,function(e,a){n=new RegExp("%"+a.value+"%","g"),r=r.replace(n,a.example)}),t.parents(".book-url").find(".widget_link_preview").html('<span class="placeholder">'+(s?e(".supapress-domain-slug").html():"")+r+"</span>"),t.parents(".retailer-link").find(".widget_link_preview").html('<span class="placeholder">'+r+"</span>"))}),t.on("blur",function(){var a=e(this);""===e.trim(a.val())&&a.data("default")&&a.val(a.data("default")),/\/$/.test(a.val())&&a.data("trim-trailing-slash")&&a.val(a.val().replace(/\/{2,}$/,"/")),a.trigger("change")}),t.trigger("blur")},e.fn.supapressAdminInit=function(){supapress.$wrap=this,supapress.$message=supapress.$wrap.find("#message"),supapress.$form=supapress.$wrap.find("#supapress-settings-form"),supapress.$urlPattern=supapress.$wrap.find(".widget_link_pattern"),supapress.$resultCountText=e("#supapress-result-count-text"),supapress.$searchTermText=e("#supapress-search-term-text"),supapress.$seoCanonical=e("#supapress-product-details-seo-canonical"),supapress.$retailerUpload=e(".retailer-image-upload"),supapress.$retailers=e(".retailer-links .retailers"),supapress.$retailerLinkFormats=e(".retailer-links .retailer_link_formats"),supapress.$addNewRetailer=e(".retailer-links .add-new-wrapper .add-new-button"),supapress.$addNewRetailerLoader=e(".retailer-links .add-new-wrapper .loading-icon");var a=function(){var a=e(this),t=a.hasClass("tracking-pattern")?"trackingPatternOptions":"bookUrlOptions";a.addAutoComplete(supapress[t])};e.each(supapress.$urlPattern,a),supapress.$resultCountText.addAutoComplete(supapress.resultCountTextOptions),supapress.$searchTermText.addAutoComplete(supapress.searchTermTextOptions),supapress.$retailerUpload.on("change paste keyup",function(){var a=e(this),t=a.siblings(".image-preview"),s=""===e.trim(a.val())?t.attr("data-default-src"):a.val();t.attr("src",s)}),supapress.$addNewRetailer.on("click",function(){supapress.$addNewRetailer.addClass("hide"),supapress.$addNewRetailerLoader.removeClass("hide"),e.ajax({url:"admin-ajax.php?action=supapress_new_retailer_link",type:"POST",data:{count:supapress.$retailerLinkFormats.length},success:function(t){supapress.$retailers.append(t),supapress.$addNewRetailer.removeClass("hide"),supapress.$addNewRetailerLoader.addClass("hide");var s=supapress.$retailers.find(".retailer-link:last-child"),n=s.find(".supapress-accordion-header"),r=s.find(".widget_link_pattern"),i=s.find(".supapress-dropdown");e.each(r,a),n.on("click",function(){var a=e(this),t=a.parents(".supapress-accordion-wrapper"),s=t.find(".svg-right-arrow"),n=t.find(".supapress-accordion-content");"none"===n.css("display")?(n.slideDown(),s.addClass("open"),a.addClass("open")):(n.slideUp(),s.removeClass("open"),a.removeClass("open"))}),e.each(i,function(){$select2=e(this).select2({width:"100%"}),$select2.data("select2").$dropdown?$select2.data("select2").$dropdown.addClass("supapress-select2-drop"):$select2.data("select2").dropdown&&$select2.data("select2").dropdown.addClass("supapress-select2-drop")}),s.find(".upload_image_button").on("click",function(){var a=s.find('input[data-button="'+e(this).attr("id")+'"]'),t=window.send_to_editor;return tb_show("","media-upload.php?type=image&TB_iframe=true"),a.on("change paste keyup",function(){var a=e(this),t=a.siblings(".image-preview"),s=""===e.trim(a.val())?t.attr("data-default-src"):a.val();t.attr("src",s)}),window.send_to_editor=function(s){var n=e("img",s).attr("src");a.val(n).trigger("change"),tb_remove(),window.send_to_editor=t},!1})}})}),supapress.$form.on("submit",function(){var a=!1;supapress.$wrap.find(".book-url .widget_link_pattern").each(function(){var t=e(this),s=t.val(),n=t.parents(".supapress-accordion-content-inner").find(".widget_link_page"),r=new RegExp("^http(s*)://"),i="",l=parseInt(n.val());if(l>0?/%isbn13%/.test(s)===!1?i='Book page URLs must contain an ISBN-13 so we can find your book. Please make sure "%isbn13%" is found in your url patterns.':r.test(s)!==!1?i="Book page URLs should not contain the full URL.":/^\//.test(s)===!1&&(i="Book page URLs must start with a slash"):l===-2&&r.test(s)===!1&&(i="External links should contain the full URL."),i)return supapress.$message.addClass("warning").removeClass("hide"),supapress.$message.find("p").text(i),supapress.$wrap.find('.nav-tab[data-tab="links"]').trigger("click"),a=!0,!1}),supapress.$wrap.find(".retailers .retailer-link ").each(function(){var t=e(this),s=t.find(".widget_retailer_name").val(),n=(t.find(".widget_link_pattern").val(),"");if(""===s.trim()?n="All retailer links require a name.":""===s.trim()&&(n="All retailer links require a link."),n)return supapress.$message.addClass("warning").removeClass("hide"),supapress.$message.find("p").text(n),supapress.$wrap.find('.nav-tab[data-tab="retailer-links"]').trigger("click"),a=!0,!1});var t=supapress.$seoCanonical.val(),s=new RegExp("^http(s*)://"),n="";if(/%isbn13%/.test(t)===!1?n='Canonical URL must contain an ISBN-13 so we can find your book. Please make sure "%isbn13%" is found in your url patterns.':s.test(t)!==!1?n="Canonical URL should not contain the full URL.":/^\//.test(t)===!1&&(n="Canonical URL must start with a slash"),n&&(supapress.$message.addClass("warning").removeClass("hide"),supapress.$message.find("p").text(n),supapress.$wrap.find('.nav-tab[data-tab="seo"]').trigger("click"),a=!0),a===!0)return window.scrollTo(0,0),!1})},e(function(){e("div.supapress-wrap.settings").supapressAdminInit()})}(jQuery);
//# sourceMappingURL=scripts.min.js.map
